(function(e){function t(t){for(var o,s,c=t[0],a=t[1],u=t[2],p=0,l=[];p<c.length;p++)s=c[p],Object.prototype.hasOwnProperty.call(i,s)&&i[s]&&l.push(i[s][0]),i[s]=0;for(o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o]);d&&d(t);while(l.length)l.shift()();return r.push.apply(r,u||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],o=!0,c=1;c<n.length;c++){var a=n[c];0!==i[a]&&(o=!1)}o&&(r.splice(t--,1),e=s(s.s=n[0]))}return e}var o={},i={app:0},r=[];function s(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=e,s.c=o,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)s.d(n,o,function(t){return e[t]}.bind(null,o));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],a=c.push.bind(c);c.push=t,c=c.slice();for(var u=0;u<c.length;u++)t(c[u]);var d=a;r.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("cd49")},"0f66":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SequentialHook=t.Hook=t.PreventableBaklavaEvent=t.BaklavaEvent=void 0;var o=n("0f9ec"),i=function(){function e(){this.listeners=new Map}return e.prototype.addListener=function(e,t){this.listeners.set(e,t)},e.prototype.removeListener=function(e){this.listeners.has(e)&&this.listeners.delete(e)},e.prototype.emit=function(e){this.listeners.forEach((function(t){return t(e)}))},e}();t.BaklavaEvent=i;var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),t.prototype.emit=function(e){var t,n;try{for(var i=o.__values(Array.from(this.listeners.values())),r=i.next();!r.done;r=i.next()){var s=r.value;if(!1===s(e))return!0}}catch(c){t={error:c}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return!1},t}(i);t.PreventableBaklavaEvent=r;var s=function(){function e(){this.tapMap=new Map,this.taps=[]}return e.prototype.tap=function(e,t){this.tapMap.has(e)&&this.untap(e),this.tapMap.set(e,t),this.taps.push(t)},e.prototype.untap=function(e){if(this.tapMap.has(e)){var t=this.tapMap.get(e);this.tapMap.delete(e);var n=this.taps.indexOf(t);n>=0&&this.taps.splice(n,1)}},e}();t.Hook=s;var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o.__extends(t,e),t.prototype.execute=function(e){var t,n,i=e;try{for(var r=o.__values(this.taps),s=r.next();!s.done;s=r.next()){var c=s.value;i=c(i)}}catch(a){t={error:a}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return i},t}(s);t.SequentialHook=c},"16ac":function(e,t,n){},5416:function(e,t,n){},bc59:function(e,t,n){"use strict";n("5416")},cd49:function(e,t,n){"use strict";n.r(t);var o={};n.r(o),n.d(o,"ButtonOption",(function(){return Je})),n.d(o,"CheckboxOption",(function(){return nt})),n.d(o,"InputOption",(function(){return st})),n.d(o,"IntegerOption",(function(){return jt})),n.d(o,"NumberOption",(function(){return St})),n.d(o,"SelectOption",(function(){return Dt})),n.d(o,"SliderOption",(function(){return Gt})),n.d(o,"TextOption",(function(){return Jt}));var i=n("f546");const r={id:"app"};function s(e,t,n,o,s,c){const a=Object(i["s"])("baklava-editor");return Object(i["n"])(),Object(i["f"])("div",r,[Object(i["h"])(a,{plugin:e.viewPlugin},null,8,["plugin"]),Object(i["h"])("button",{onClick:t[1]||(t[1]=(...t)=>e.calculate&&e.calculate(...t))},"Calculate"),Object(i["h"])("button",{onClick:t[2]||(t[2]=(...t)=>e.save&&e.save(...t))},"Save"),Object(i["h"])("button",{onClick:t[3]||(t[3]=(...t)=>e.load&&e.load(...t))},"Load"),Object(i["h"])("button",{onFocus:t[4]||(t[4]=t=>e.focusState="focus"),onBlur:t[5]||(t[5]=t=>e.focusState="blur")},Object(i["v"])(e.focusState),33),Object(i["h"])("button",{onClick:t[6]||(t[6]=(...t)=>e.setSelectItems&&e.setSelectItems(...t))},"Set Select Items"),Object(i["h"])("button",{onClick:t[7]||(t[7]=(...t)=>e.changeGridSize&&e.changeGridSize(...t))},"Change Grid Size")])}var c=n("0f9e"),a=n("7e44"),u=0;function d(){return Date.now().toString()+(u++).toString()}var p=n("0f66"),l=function(){function e(e,t){if(this.isInDanger=!1,this.destructed=!1,this.events={destruct:new p["BaklavaEvent"]},!e||!t)throw new Error("Cannot initialize connection with null/undefined for 'from' or 'to' values");this.id=d(),this.from=e,this.to=t,this.from.connectionCount++,this.to.connectionCount++}return e.prototype.destruct=function(){this.events.destruct.emit(),this.from.connectionCount--,this.to.connectionCount--,this.destructed=!0},e}(),h=function(){function e(e,t){if(!e||!t)throw new Error("Cannot initialize connection with null/undefined for 'from' or 'to' values");this.id=d(),this.from=e,this.to=t}return e}(),f=function(){function e(){this._plugins=new Set,this._nodes=[],this._connections=[],this._nodeTypes=new Map,this._nodeCategories=new Map([["default",[]]]),this.events={beforeRegisterNodeType:new p["PreventableBaklavaEvent"],registerNodeType:new p["BaklavaEvent"],beforeAddNode:new p["PreventableBaklavaEvent"],addNode:new p["BaklavaEvent"],beforeRemoveNode:new p["PreventableBaklavaEvent"],removeNode:new p["BaklavaEvent"],beforeAddConnection:new p["PreventableBaklavaEvent"],addConnection:new p["BaklavaEvent"],checkConnection:new p["PreventableBaklavaEvent"],beforeRemoveConnection:new p["PreventableBaklavaEvent"],removeConnection:new p["BaklavaEvent"],beforeUsePlugin:new p["PreventableBaklavaEvent"],usePlugin:new p["BaklavaEvent"]},this.hooks={save:new p["SequentialHook"],load:new p["SequentialHook"]}}return Object.defineProperty(e.prototype,"nodes",{get:function(){return this._nodes},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"connections",{get:function(){return this._connections},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nodeTypes",{get:function(){return this._nodeTypes},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nodeCategories",{get:function(){return this._nodeCategories},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"plugins",{get:function(){return this._plugins},enumerable:!1,configurable:!0}),e.prototype.registerNodeType=function(e,t,n){void 0===n&&(n="default"),this.events.beforeRegisterNodeType.emit({typeName:e,type:t,category:n})||(this._nodeTypes.set(e,t),this.nodeCategories.has(n)||this._nodeCategories.set(n,[]),this.nodeCategories.get(n).push(e),this.events.registerNodeType.emit({typeName:e,type:t,category:n}))},e.prototype.addNode=function(e){if(!this.events.beforeAddNode.emit(e))return e.registerEditor(this),this._nodes.push(e),this.events.addNode.emit(e),e},e.prototype.removeNode=function(e){var t=this;if(this.nodes.includes(e)){if(this.events.beforeRemoveNode.emit(e))return;this.connections.filter((function(t){return t.from.parent===e||t.to.parent===e})).forEach((function(e){return t.removeConnection(e)})),this._nodes.splice(this.nodes.indexOf(e),1),this.events.removeNode.emit(e)}},e.prototype.addConnection=function(e,t){var n=this.checkConnection(e,t);if(n&&!this.events.beforeAddConnection.emit({from:e,to:t})){var o=new l(n.from,n.to);return this._connections.push(o),this.events.addConnection.emit(o),o}},e.prototype.removeConnection=function(e){if(this.connections.includes(e)){if(this.events.beforeRemoveConnection.emit(e))return;e.destruct(),this._connections.splice(this.connections.indexOf(e),1),this.events.removeConnection.emit(e)}},e.prototype.checkConnection=function(e,t){if(!e||!t)return!1;if(e.parent===t.parent)return!1;if(e.isInput&&!t.isInput){var n=e;e=t,t=n}return!(e.isInput||!t.isInput)&&(!this.connections.some((function(n){return n.from===e&&n.to===t}))&&(!this.events.checkConnection.emit({from:e,to:t})&&new h(e,t)))},e.prototype.load=function(e){for(var t,n,o,i,r=[],s=this.connections.length-1;s>=0;s--)this.removeConnection(this.connections[s]);for(s=this.nodes.length-1;s>=0;s--)this.removeNode(this.nodes[s]);try{for(var a=Object(c["h"])(e.nodes),u=a.next();!u.done;u=a.next()){var d=u.value,p=this.nodeTypes.get(d.type);if(p){var l=new p;this.addNode(l),l.load(d)}else r.push("Node type "+d.type+" is not registered")}}catch(O){t={error:O}}finally{try{u&&!u.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}try{for(var h=Object(c["h"])(e.connections),f=h.next();!f.done;f=h.next()){var v=f.value,b=this.findNodeInterface(v.from),y=this.findNodeInterface(v.to);if(b)if(y){var m=this.addConnection(b,y);m?m.id=v.id:r.push("Unable to create connection from "+v.from+" to "+v.to)}else r.push("Could not find interface with id "+v.to);else r.push("Could not find interface with id "+v.from)}}catch(g){o={error:g}}finally{try{f&&!f.done&&(i=h.return)&&i.call(h)}finally{if(o)throw o.error}}return this.hooks.load.execute(e),r.forEach((function(e){return console.warn(e)})),r},e.prototype.save=function(){var e={nodes:this.nodes.map((function(e){return e.save()})),connections:this.connections.map((function(e){return{id:e.id,from:e.from.id,to:e.to.id}}))};return this.hooks.save.execute(e)},e.prototype.use=function(e){return!this.events.beforeUsePlugin.emit(e)&&(this._plugins.add(e),e.register(this),this.events.usePlugin.emit(e),!0)},e.prototype.generateId=function(e){return void 0===e&&(e=""),e+d()},e.prototype.findNodeInterface=function(e){var t,n,o,i;try{for(var r=Object(c["h"])(this.nodes),s=r.next();!s.done;s=r.next()){var a=s.value;try{for(var u=(o=void 0,Object(c["h"])(a.interfaces.keys())),d=u.next();!d.done;d=u.next()){var p=d.value;if(a.interfaces.get(p).id===e)return a.interfaces.get(p)}}catch(l){o={error:l}}finally{try{d&&!d.done&&(i=u.return)&&i.call(u)}finally{if(o)throw o.error}}}}catch(h){t={error:h}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}},e}(),v=function(){function e(e,t){this.events={setConnectionCount:new p["BaklavaEvent"],beforeSetValue:new p["PreventableBaklavaEvent"],setValue:new p["BaklavaEvent"],updated:new p["BaklavaEvent"]},this.hooks={load:new p["SequentialHook"],save:new p["SequentialHook"]},this._connectionCount=0,this._value=null,this.parent=e,this.isInput=t,this.id="ni_"+d()}return Object.defineProperty(e.prototype,"connectionCount",{get:function(){return this._connectionCount},set:function(e){this._connectionCount=e,this.events.setConnectionCount.emit(e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(e){this.events.beforeSetValue.emit(e)||(this._value=e,this.events.setValue.emit(e))},enumerable:!1,configurable:!0}),e.prototype.load=function(e){this.id=e.id,this.value=e.value,this.hooks.load.execute(e)},e.prototype.save=function(){var e={id:this.id,value:this.value};return this.hooks.save.execute(e)},e}(),b=function(){function e(e,t,n){this.events={beforeSetValue:new p["PreventableBaklavaEvent"],setValue:new p["BaklavaEvent"],updated:new p["BaklavaEvent"]},this.optionComponent=e,this.sidebarComponent=n,this._value=t}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(e){this.events.beforeSetValue.emit(e)||(this._value=e,this.events.setValue.emit(e))},enumerable:!1,configurable:!0}),e}(),y=function(){function e(){this.id="node_"+d(),this.interfaces=new Map,this.options=new Map,this.state={},this.events={beforeAddInterface:new p["PreventableBaklavaEvent"],addInterface:new p["BaklavaEvent"],beforeRemoveInterface:new p["PreventableBaklavaEvent"],removeInterface:new p["BaklavaEvent"],beforeAddOption:new p["PreventableBaklavaEvent"],addOption:new p["BaklavaEvent"],beforeRemoveOption:new p["PreventableBaklavaEvent"],removeOption:new p["BaklavaEvent"],update:new p["BaklavaEvent"]},this.hooks={load:new p["SequentialHook"],save:new p["SequentialHook"]}}return Object.defineProperty(e.prototype,"inputInterfaces",{get:function(){var e={};return this.interfaces.forEach((function(t,n){t.isInput&&(e[n]=t)})),e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"outputInterfaces",{get:function(){var e={};return this.interfaces.forEach((function(t,n){t.isInput||(e[n]=t)})),e},enumerable:!1,configurable:!0}),e.prototype.load=function(e){var t=this;this.id=e.id,this.name=e.name,this.state=e.state,e.options.forEach((function(e){var n=Object(c["f"])(e,2),o=n[0],i=n[1];t.options.has(o)&&(t.options.get(o).value=i)})),e.interfaces.forEach((function(e){var n=Object(c["f"])(e,2),o=n[0],i=n[1];t.interfaces.has(o)&&t.interfaces.get(o).load(i)})),this.hooks.load.execute(e)},e.prototype.save=function(){var e={type:this.type,id:this.id,name:this.name,options:Array.from(this.options.entries()).map((function(e){var t=Object(c["f"])(e,2),n=t[0],o=t[1];return[n,o.value]})),state:this.state,interfaces:Array.from(this.interfaces.entries()).map((function(e){var t=Object(c["f"])(e,2),n=t[0],o=t[1];return[n,o.save()]}))};return this.hooks.save.execute(e)},e.prototype.calculate=function(e){},e.prototype.addInputInterface=function(e,t,n,o){var i=this;if(void 0===n&&(n=null),!this.events.beforeAddInterface.emit({name:e,isInput:!0,option:t,defaultValue:n})){var r=this.addInterface(!0,e,t);return r.events.setValue.addListener(this,(function(){return i.events.update.emit({name:e,interface:r})})),r.value=n,Object.entries(o||{}).forEach((function(e){var t=Object(c["f"])(e,2),n=t[0],o=t[1];r[n]=o})),this.events.addInterface.emit(r),r}},e.prototype.addOutputInterface=function(e,t){if(!this.events.beforeAddInterface.emit({name:e,isInput:!1})){var n=this.addInterface(!1,e);return Object.entries(t||{}).forEach((function(e){var t=Object(c["f"])(e,2),o=t[0],i=t[1];n[o]=i})),this.events.addInterface.emit(n),n}},e.prototype.removeInterface=function(e){var t=this,n=this.getInterface(e);if(n){if(this.events.beforeRemoveInterface.emit(n))return;if(n.connectionCount>0){if(!this.editorInstance)throw new Error("Interface is connected, but no editor instance is specified. Unable to delete interface");var o=this.editorInstance.connections.filter((function(e){return e.from===n||e.to===n}));o.forEach((function(e){t.editorInstance.removeConnection(e)}))}this.interfaces.delete(e),this.events.removeInterface.emit(n)}},e.prototype.addOption=function(e,t,n,o,i){var r=this;if(void 0===n&&(n=null),!this.events.beforeAddOption.emit({name:e,component:t,defaultValue:n,sidebarComponent:o})){var s=new b(t,n,o);return Object.entries(i||{}).forEach((function(e){var t=Object(c["f"])(e,2),n=t[0],o=t[1];s[n]=o})),s.events.setValue.addListener(this,(function(){r.events.update.emit({name:e,option:s})})),this.options.set(e,s),this.events.addOption.emit({name:e,option:s}),s}},e.prototype.removeOption=function(e){if(this.options.has(e)){var t=this.options.get(e);if(this.events.beforeRemoveOption.emit({name:e,option:t}))return;this.options.delete(e),this.events.removeOption.emit({name:e,option:t})}},e.prototype.getInterface=function(e){if(!this.interfaces.has(e))throw new Error("No interface named '"+e+"'");return this.interfaces.get(e)},e.prototype.getOptionValue=function(e){if(!this.options.has(e))throw new Error("No option named '"+e+"'");return this.options.get(e).value},e.prototype.setOptionValue=function(e,t){if(!this.options.has(e))throw new Error("No option named '"+e+"'");this.options.get(e).value=t},e.prototype.registerEditor=function(e){this.editorInstance=e},e.prototype.addInterface=function(e,t,n){var o=new v(this,e);return o.option=n,this.interfaces.set(t,o),o},e}();function m(e){return"function"===typeof e?e():e}function O(e,t,n,o,i,r){return function(s){function a(){var r,a,u=s.call(this)||this;u.type=e,u.name=t,n&&Object.assign(u,n);try{for(var d=Object(c["h"])(o),p=d.next();!p.done;p=d.next()){var l=p.value;l.isInput?u.addInputInterface(l.name,l.option,m(l.defaultValue),l.additionalProperties):u.addOutputInterface(l.name,l.additionalProperties)}}catch(h){r={error:h}}finally{try{p&&!p.done&&(a=d.return)&&a.call(d)}finally{if(r)throw r.error}}return Array.from(i.entries()).forEach((function(e){var t=Object(c["f"])(e,2),n=t[0],o=t[1];u.addOption(n,o.optionComponent,m(o.value),o.sidebarComponent,o.additionalProperties)})),u}return Object(c["d"])(a,s),a.prototype.calculate=function(e){if(r)return r.call(this,this,e)},a}(y)}var g=function(){function e(e,t){this.type="",this.name="",this.intfs=[],this.options=new Map,this.type=e,this.name=e,this.additionalProperties=t}return e.prototype.build=function(){return O(this.type,this.name,this.additionalProperties,this.intfs,this.options,this.calcFunction)},e.prototype.setName=function(e){return this.name=e,this},e.prototype.addInputInterface=function(e,t,n,o){return void 0===n&&(n=null),this.checkDefaultValue(n),this.intfs.push({isInput:!0,name:e,option:t,defaultValue:n,additionalProperties:o}),this},e.prototype.addOutputInterface=function(e,t){return this.intfs.push({isInput:!1,name:e,additionalProperties:t}),this},e.prototype.addOption=function(e,t,n,o,i){return void 0===n&&(n=null),this.checkDefaultValue(n),this.options.set(e,{value:n,optionComponent:t,sidebarComponent:o,additionalProperties:i}),this},e.prototype.onCalculate=function(e){return this.calcFunction=e,this},e.prototype.checkDefaultValue=function(e){if("object"===typeof e&&null!==e)throw new Error("If the default value is an object, provide a generator function instead of the object")},e}();const j={class:"connections-container"};function x(e,t,n,o,r,s){return Object(i["n"])(),Object(i["f"])("div",{tabindex:"-1",class:["node-editor",{"ignore-mouse":!!e.temporaryConnection,"--temporary-connection":!!e.temporaryConnection}],onMousemove:t[2]||(t[2]=Object(i["C"])((...t)=>e.mouseMoveHandler&&e.mouseMoveHandler(...t),["self"])),onMousedown:t[3]||(t[3]=(...t)=>e.mouseDown&&e.mouseDown(...t)),onMouseup:t[4]||(t[4]=(...t)=>e.mouseUp&&e.mouseUp(...t)),onWheel:t[5]||(t[5]=Object(i["C"])((...t)=>e.mouseWheel&&e.mouseWheel(...t),["self"])),onKeydown:t[6]||(t[6]=(...t)=>e.keyDown&&e.keyDown(...t)),onKeyup:t[7]||(t[7]=(...t)=>e.keyUp&&e.keyUp(...t)),onContextmenu:t[8]||(t[8]=Object(i["C"])((...t)=>e.openContextMenu&&e.openContextMenu(...t),["self","prevent"]))},[Object(i["h"])("div",{class:"background",style:e.backgroundStyle},null,4),(Object(i["n"])(),Object(i["f"])("svg",j,[(Object(i["n"])(!0),Object(i["f"])(i["a"],null,Object(i["q"])(e.connections,t=>(Object(i["n"])(),Object(i["f"])("g",{key:t.id+e.counter.toString()},[Object(i["r"])(e.$slots,"connections",{connection:t},()=>[(Object(i["n"])(),Object(i["f"])(Object(i["u"])(e.plugin.components.connection),{connection:t},null,8,["connection"]))])]))),128)),e.temporaryConnection?(Object(i["n"])(),Object(i["f"])(Object(i["u"])(e.plugin.components.tempConnection),{key:0,connection:e.temporaryConnection},null,8,["connection"])):Object(i["g"])("",!0)])),Object(i["h"])("div",{class:"node-container",style:e.styles},[(Object(i["n"])(!0),Object(i["f"])(i["a"],null,Object(i["q"])(e.nodes,t=>(Object(i["n"])(),Object(i["f"])(Object(i["u"])(e.plugin.components.node),{key:t.id+e.counter.toString(),node:t,selected:e.selectedNodes.includes(t),onSelect:n=>e.selectNode(t,n)},null,8,["node","selected","onSelect"]))),128))],4),(Object(i["n"])(),Object(i["f"])(Object(i["u"])(e.plugin.components.contextMenu),{modelValue:e.contextMenu.show,"onUpdate:modelValue":t[1]||(t[1]=t=>e.contextMenu.show=t),x:e.contextMenu.x,y:e.contextMenu.y,items:e.contextMenu.items,flippable:"",onClick:e.onContextMenuClick},null,8,["modelValue","x","y","items","onClick"])),(Object(i["n"])(),Object(i["f"])(Object(i["u"])(e.plugin.components.sidebar))),e.plugin.enableMinimap?(Object(i["n"])(),Object(i["f"])(Object(i["u"])(e.plugin.components.minimap),{key:0,nodes:e.nodes,connections:e.connections},null,8,["nodes","connections"])):Object(i["g"])("",!0)],34)}var w;(function(e){e[e["NONE"]=0]="NONE",e[e["ALLOWED"]=1]="ALLOWED",e[e["FORBIDDEN"]=2]="FORBIDDEN"})(w||(w={}));var C=function(){function e(e){this.nodeBuffer="",this.connectionBuffer="",this.editor=e}return Object.defineProperty(e.prototype,"isEmpty",{get:function(){return!this.nodeBuffer},enumerable:!1,configurable:!0}),e.prototype.clear=function(){this.nodeBuffer="",this.connectionBuffer=""},e.prototype.copy=function(e){this.connectionBuffer=JSON.stringify(this.editor.connections.filter((function(t){return e.includes(t.from.parent)&&e.includes(t.to.parent)})).map((function(e){return{from:e.from.id,to:e.to.id}}))),this.nodeBuffer=JSON.stringify(e.map((function(e){return e.save()})))},e.prototype.paste=function(){var e,t,n,o,i=this,r=new Map,s=new Map,a=JSON.parse(this.nodeBuffer),u=JSON.parse(this.connectionBuffer),d=function(e){var t=p.editor.nodeTypes.get(e.type);if(!t)return console.warn("Node type "+e.type+" not registered"),{value:void 0};var n=new t,o=n.id;n.interfaces.forEach((function(e){e.hooks.load.tap(i,(function(t){var n=i.editor.generateId("ni");return r.set(t.id,n),s.set(t.id,o),e.id=n,e.hooks.load.untap(i),t}))})),n.hooks.load.tap(p,(function(e){var t=e;return t.position&&(t.position.x+=10,t.position.y+=10),t})),p.editor.addNode(n),n.load(e),n.id=o,r.set(e.id,o)},p=this;try{for(var l=Object(c["h"])(a),h=l.next();!h.done;h=l.next()){var f=h.value,v=d(f);if("object"===typeof v)return v.value}}catch(j){e={error:j}}finally{try{h&&!h.done&&(t=l.return)&&t.call(l)}finally{if(e)throw e.error}}var b=function(e){var t=y.editor.nodes.find((function(t){return t.id===s.get(e.from)})),n=y.editor.nodes.find((function(t){return t.id===s.get(e.to)}));if(!t||!n)return"continue";var o=Array.from(t.interfaces.values()).find((function(t){return t.id===r.get(e.from)})),i=Array.from(n.interfaces.values()).find((function(t){return t.id===r.get(e.to)}));if(!o||!i)return"continue";y.editor.addConnection(o,i)},y=this;try{for(var m=Object(c["h"])(u),O=m.next();!O.done;O=m.next()){var g=O.value;b(g)}}catch(x){n={error:x}}finally{try{O&&!O.done&&(o=m.return)&&o.call(m)}finally{if(n)throw n.error}}},e}(),N=C,k=function(){function e(e,t){this.type=e,"addNode"===e?this.nodeId=t:this.nodeState=t}return e.prototype.undo=function(e){"addNode"===this.type?this.removeNode(e):this.addNode(e)},e.prototype.redo=function(e){"addNode"===this.type&&this.nodeState?this.addNode(e):"removeNode"===this.type&&this.nodeId&&this.removeNode(e)},e.prototype.addNode=function(e){var t=e.nodeTypes.get(this.nodeState.type);if(t){var n=new t;e.addNode(n),n.load(this.nodeState),this.nodeId=n.id}},e.prototype.removeNode=function(e){var t=this,n=e.nodes.find((function(e){return e.id===t.nodeId}));n&&(this.nodeState=n.save(),e.removeNode(n))},e}(),I=k,M=function(){function e(e,t){if(this.type=e,"addConnection"===e)this.connectionId=t;else{var n=t;this.connectionState={id:n.id,from:n.from.id,to:n.to.id}}}return e.prototype.undo=function(e){"addConnection"===this.type?this.removeConnection(e):this.addConnection(e)},e.prototype.redo=function(e){"addConnection"===this.type&&this.connectionState?this.addConnection(e):"removeConnection"===this.type&&this.connectionId&&this.removeConnection(e)},e.prototype.addConnection=function(e){var t=e.findNodeInterface(this.connectionState.from),n=e.findNodeInterface(this.connectionState.to);t&&n&&e.addConnection(t,n)},e.prototype.removeConnection=function(e){var t=this,n=e.connections.find((function(e){return e.id===t.connectionId}));n&&(this.connectionState={id:n.id,from:n.from.id,to:n.to.id},e.removeConnection(n))},e}(),S=M,P=function(){function e(e){var t=this;this.maxSteps=200,this.steps=[],this.changeBySelf=!1,this.currentIndex=-1,this.activeTransaction=!1,this.transactionSteps=[],this.viewPlugin=e,this.viewPlugin.editor.events.addNode.addListener(this,(function(e){t.addStep(new I("addNode",e.id))})),this.viewPlugin.editor.events.removeNode.addListener(this,(function(e){t.addStep(new I("removeNode",e.save()))})),this.viewPlugin.editor.events.addConnection.addListener(this,(function(e){t.addStep(new S("addConnection",e.id))})),this.viewPlugin.editor.events.removeConnection.addListener(this,(function(e){t.addStep(new S("removeConnection",e))}))}return e.prototype.startTransaction=function(){this.activeTransaction=!0},e.prototype.commitTransaction=function(){this.activeTransaction=!1},e.prototype.undo=function(){0!==this.steps.length&&-1!==this.currentIndex&&(this.changeBySelf=!0,this.steps[this.currentIndex--].undo(this.viewPlugin.editor),this.changeBySelf=!1)},e.prototype.redo=function(){0===this.steps.length||this.currentIndex>=this.steps.length-1||(this.changeBySelf=!0,this.steps[++this.currentIndex].redo(this.viewPlugin.editor),this.changeBySelf=!1)},e.prototype.addStep=function(e){if(!this.changeBySelf)if(this.activeTransaction)this.transactionSteps.push(e);else{this.currentIndex!==this.steps.length-1&&(this.steps=this.steps.slice(0,this.currentIndex+1)),this.steps.push(e),this.currentIndex++;while(this.steps.length>this.maxSteps)this.steps.shift()}},e}(),E=P,_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.nodeeditor=t,t.selectedNodeViews=[],t.temporaryConnection=null,t.hoveringOver=null,t.selectedNodes=[],t.ctrlPressed=!1,t.draggingStartPoint=null,t.draggingStartPanning=null,t.counter=0,t.contextMenu={items:[],show:!1,x:0,y:0},t}return Object(c["d"])(t,e),Object.defineProperty(t.prototype,"styles",{get:function(){return{"transform-origin":"0 0",transform:"scale("+this.plugin.scaling+") translate("+this.plugin.panning.x+"px, "+this.plugin.panning.y+"px)"}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"backgroundStyle",{get:function(){var e=this.plugin.panning.x*this.plugin.scaling,t=this.plugin.panning.y*this.plugin.scaling,n=this.plugin.scaling*this.plugin.backgroundGrid.gridSize,o=n/this.plugin.backgroundGrid.gridDivision,i=n+"px "+n+"px, "+n+"px "+n+"px",r=this.plugin.scaling>this.plugin.backgroundGrid.subGridVisibleThreshold?", "+o+"px "+o+"px, "+o+"px "+o+"px":"";return{"background-position":"left "+e+"px top "+t+"px","background-size":i+" "+r}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nodes",{get:function(){return this.plugin.editor?this.plugin.editor.nodes:[]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"connections",{get:function(){return this.plugin.editor?this.plugin.editor.connections:[]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasEnginePlugin",{get:function(){var e,t;try{for(var n=Object(c["h"])(this.plugin.editor.plugins.values()),o=n.next();!o.done;o=n.next()){var i=o.value;if("EnginePlugin"===i.type)return!0}}catch(r){e={error:r}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}return!1},enumerable:!1,configurable:!0}),t.prototype.mounted=function(){var e=this;this.updateContextMenu(),this.plugin.editor.events.registerNodeType.addListener(this,(function(){return e.updateContextMenu()})),this.plugin.editor.hooks.load.tap(this,(function(t){return e.counter++,t})),this.clipboard=new N(this.plugin.editor),this.history=new E(this.plugin)},t.prototype.updateContextMenu=function(){var e=this,t=Array.from(this.plugin.editor.nodeCategories.keys()).filter((function(e){return"default"!==e})).map((function(t){var n=Array.from(e.plugin.editor.nodeCategories.get(t)).map((function(t){return{value:"addNode:"+t,label:e.plugin.nodeTypeAliases[t]||t}}));return{label:t,submenu:n}})),n=this.plugin.editor.nodeCategories.get("default").map((function(t){return{value:"addNode:"+t,label:e.plugin.nodeTypeAliases[t]||t}})),o=Object(c["g"])(t);t.length>0&&n.length>0&&o.push({isDivider:!0}),o.push.apply(o,Object(c["g"])(n)),this.contextMenu.items=[{label:"Add Node",submenu:o},{label:"Copy Nodes",value:"copy",disabledFunction:function(){return 0===e.selectedNodes.length}},{label:"Paste Nodes",value:"paste",disabledFunction:function(){return e.clipboard.isEmpty}}]},t.prototype.hoveredOver=function(e){this.hoveringOver=e,e&&this.temporaryConnection?(this.temporaryConnection.to=e,this.temporaryConnection.status=this.plugin.editor.checkConnection(this.temporaryConnection.from,this.temporaryConnection.to)?w.ALLOWED:w.FORBIDDEN,this.hasEnginePlugin&&this.connections.filter((function(t){return t.to===e})).forEach((function(e){e.isInDanger=!0}))):!e&&this.temporaryConnection&&(this.temporaryConnection.to=void 0,this.temporaryConnection.status=w.NONE,this.connections.forEach((function(e){e.isInDanger=!1})))},t.prototype.mouseMoveHandler=function(e){if(this.temporaryConnection)this.temporaryConnection.mx=e.offsetX/this.plugin.scaling-this.plugin.panning.x,this.temporaryConnection.my=e.offsetY/this.plugin.scaling-this.plugin.panning.y;else if(this.draggingStartPoint){var t=e.screenX-this.draggingStartPoint.x,n=e.screenY-this.draggingStartPoint.y;this.plugin.panning.x=this.draggingStartPanning.x+t/this.plugin.scaling,this.plugin.panning.y=this.draggingStartPanning.y+n/this.plugin.scaling}},t.prototype.mouseDown=function(e){var t=this;if(0===e.button)if(this.hoveringOver){var n=this.connections.find((function(e){return e.to===t.hoveringOver}));this.hoveringOver.isInput&&n?(this.temporaryConnection={status:w.NONE,from:n.from},this.plugin.editor.removeConnection(n)):this.temporaryConnection={status:w.NONE,from:this.hoveringOver},this.temporaryConnection.mx=null,this.temporaryConnection.my=null}else e.target===this.$el&&(this.unselectAllNodes(),this.draggingStartPoint={x:e.screenX,y:e.screenY},this.draggingStartPanning={x:this.plugin.panning.x,y:this.plugin.panning.y})},t.prototype.mouseUp=function(){this.draggingStartPoint=null,this.draggingStartPanning=null;var e=this.temporaryConnection;e&&this.hoveringOver&&this.plugin.editor.addConnection(e.from,e.to),this.temporaryConnection=null},t.prototype.mouseWheel=function(e){e.preventDefault();var t=e.deltaY;1===e.deltaMode&&(t*=32);var n=this.plugin.scaling*(1-t/3e3),o=[e.offsetX/this.plugin.scaling-this.plugin.panning.x,e.offsetY/this.plugin.scaling-this.plugin.panning.y],i=[e.offsetX/n-this.plugin.panning.x,e.offsetY/n-this.plugin.panning.y],r=[i[0]-o[0],i[1]-o[1]];this.plugin.panning.x+=r[0],this.plugin.panning.y+=r[1],this.plugin.scaling=n},t.prototype.keyDown=function(e){var t=this;"Delete"===e.key&&this.selectedNodes.length>0?this.selectedNodes.forEach((function(e){return t.plugin.editor.removeNode(e)})):"Tab"===e.key?e.preventDefault():"Control"===e.key?this.ctrlPressed=!0:"z"===e.key&&e.ctrlKey?this.history.undo():"y"===e.key&&e.ctrlKey&&this.history.redo()},t.prototype.keyUp=function(e){"Control"===e.key&&(this.ctrlPressed=!1)},t.prototype.selectNode=function(e,t){this.ctrlPressed||this.unselectAllNodes(),this.selectedNodes.push(e),this.selectedNodeViews.push(t)},t.prototype.unselectAllNodes=function(){this.selectedNodes.splice(0,this.selectedNodes.length),this.selectedNodeViews.splice(0,this.selectedNodeViews.length)},t.prototype.openContextMenu=function(e){this.contextMenu.show=!0,this.contextMenu.x=e.offsetX,this.contextMenu.y=e.offsetY},t.prototype.onContextMenuClick=function(e){if(e.startsWith("addNode:")){var t=e.substring(e.indexOf(":")+1),n=this.plugin.editor.nodeTypes.get(t);if(n){var o=this.plugin.editor.addNode(new n);o&&(o.position.x=this.contextMenu.x/this.plugin.scaling-this.plugin.panning.x,o.position.y=this.contextMenu.y/this.plugin.scaling-this.plugin.panning.y)}}else"copy"===e&&this.selectedNodes.length>0?this.clipboard.copy(this.selectedNodes):"paste"!==e||this.clipboard.isEmpty||this.clipboard.paste()},Object(c["c"])([Object(a["c"])({type:Object,required:!0}),Object(a["d"])()],t.prototype,"plugin",void 0),Object(c["c"])([Object(a["d"])({to:"editor"})],t.prototype,"nodeeditor",void 0),Object(c["c"])([Object(a["d"])()],t.prototype,"selectedNodeViews",void 0),Object(c["c"])([Object(a["f"])("plugin.nodeTypeAliases")],t.prototype,"updateContextMenu",null),t}(a["e"]),T=_;T.render=x;var V=T;function B(e,t,n,o,r,s){return Object(i["n"])(),Object(i["f"])("path",{d:e.d,class:e.classes},null,10,["d"])}var L=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(c["d"])(t,e),t.prototype.mounted=function(){this.plugin.hooks.renderConnection.execute(this)},t.prototype.updated=function(){this.plugin.hooks.renderConnection.execute(this)},Object.defineProperty(t.prototype,"d",{get:function(){var e=Object(c["f"])(this.transform(this.x1,this.y1),2),t=e[0],n=e[1],o=Object(c["f"])(this.transform(this.x2,this.y2),2),i=o[0],r=o[1];if(this.plugin.useStraightConnections)return"M "+t+" "+n+" L "+i+" "+r;var s=.3*Math.abs(t-i);return"M "+t+" "+n+" C "+(t+s)+" "+n+", "+(i-s)+" "+r+", "+i+" "+r},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"classes",{get:function(){return{connection:!0,"--temporary":this.isTemporary,"--allowed":this.state===w.ALLOWED,"--forbidden":this.state===w.FORBIDDEN}},enumerable:!1,configurable:!0}),t.prototype.transform=function(e,t){var n=(e+this.plugin.panning.x)*this.plugin.scaling,o=(t+this.plugin.panning.y)*this.plugin.scaling;return[n,o]},Object(c["c"])([Object(a["c"])({type:Number})],t.prototype,"x1",void 0),Object(c["c"])([Object(a["c"])({type:Number})],t.prototype,"y1",void 0),Object(c["c"])([Object(a["c"])({type:Number})],t.prototype,"x2",void 0),Object(c["c"])([Object(a["c"])({type:Number})],t.prototype,"y2",void 0),Object(c["c"])([Object(a["c"])({type:Number,default:w.NONE})],t.prototype,"state",void 0),Object(c["c"])([Object(a["c"])({type:Boolean,default:!1})],t.prototype,"isTemporary",void 0),Object(c["c"])([Object(a["c"])({type:Object})],t.prototype,"connection",void 0),Object(c["c"])([Object(a["a"])()],t.prototype,"plugin",void 0),t}(a["e"]),A=L;A.render=B;var D=A;function R(e,t,n,o,r,s){const c=Object(i["s"])("connection-view");return Object(i["n"])(),Object(i["f"])(c,{x1:e.d.x1,y1:e.d.y1,x2:e.d.x2,y2:e.d.y2,state:e.state,connection:e.connection},null,8,["x1","y1","x2","y2","state","connection"])}var $=n("06be");function H(e){return document.getElementById(e.id)}function F(e){var t=document.getElementById(e.parent.id),n=document.getElementById(e.id),o=null===n||void 0===n?void 0:n.getElementsByClassName("__port");return{node:t,interface:n,port:o&&o.length>0?o[0]:null}}var z=window.ResizeObserver||$["a"],X=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.d={x1:0,y1:0,x2:0,y2:0},t}return Object(c["d"])(t,e),Object.defineProperty(t.prototype,"state",{get:function(){return this.connection.isInDanger?w.FORBIDDEN:w.NONE},enumerable:!1,configurable:!0}),t.prototype.mounted=function(){return Object(c["b"])(this,void 0,void 0,(function(){return Object(c["e"])(this,(function(e){switch(e.label){case 0:return[4,this.$nextTick()];case 1:return e.sent(),this.updateCoords(),[2]}}))}))},t.prototype.beforeDestroy=function(){this.resizeObserver.disconnect()},t.prototype.updateCoords=function(){var e=this,t=F(this.connection.from),n=F(this.connection.to);t.node&&n.node&&(this.resizeObserver||(this.resizeObserver=new z((function(){e.updateCoords()})),this.resizeObserver.observe(t.node),this.resizeObserver.observe(n.node)));var o=Object(c["f"])(this.getPortCoordinates(t),2),i=o[0],r=o[1],s=Object(c["f"])(this.getPortCoordinates(n),2),a=s[0],u=s[1];this.d={x1:i,y1:r,x2:a,y2:u}},t.prototype.getPortCoordinates=function(e){return e.node&&e.interface&&e.port?[e.node.offsetLeft+e.interface.offsetLeft+e.port.offsetLeft+e.port.clientWidth/2,e.node.offsetTop+e.interface.offsetTop+e.port.offsetTop+e.port.clientHeight/2]:[0,0]},Object(c["c"])([Object(a["c"])({type:Object})],t.prototype,"connection",void 0),Object(c["c"])([Object(a["f"])("connection.from.parent.position",{deep:!0}),Object(a["f"])("connection.to.parent.position",{deep:!0})],t.prototype,"updateCoords",null),t=Object(c["c"])([Object(a["b"])({components:{"connection-view":D}})],t),t}(a["e"]),q=X;q.render=R;var G=q;function U(e,t,n,o,r,s){const c=Object(i["s"])("connection-view");return Object(i["n"])(),Object(i["f"])(c,{x1:e.d.input[0],y1:e.d.input[1],x2:e.d.output[0],y2:e.d.output[1],state:e.status,connection:e.connection,"is-temporary":""},null,8,["x1","y1","x2","y2","state","connection"])}function W(e){return e.node&&e.interface&&e.port?[e.node.offsetLeft+e.interface.offsetLeft+e.port.offsetLeft+e.port.clientWidth/2,e.node.offsetTop+e.interface.offsetTop+e.port.offsetTop+e.port.clientHeight/2]:[0,0]}var Y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(c["d"])(t,e),Object.defineProperty(t.prototype,"status",{get:function(){return this.connection?this.connection.status:w.NONE},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"d",{get:function(){if(!this.connection)return{input:[0,0],output:[0,0]};var e=W(F(this.connection.from)),t=this.connection.to?W(F(this.connection.to)):[this.connection.mx||e[0],this.connection.my||e[1]];return this.connection.from.isInput?{input:t,output:e}:{input:e,output:t}},enumerable:!1,configurable:!0}),Object(c["c"])([Object(a["c"])({type:Object})],t.prototype,"connection",void 0),t=Object(c["c"])([Object(a["b"])({components:{"connection-view":D}})],t),t}(a["e"]),J=Y;J.render=U;var K=J;const Z={key:0},Q={class:"__content"},ee={class:"__outputs"},te={class:"__options"},ne={class:"__inputs"};function oe(e,t,n,o,r,s){const c=Object(i["t"])("click-outside");return Object(i["n"])(),Object(i["f"])("div",{id:e.node.id,class:e.classes,style:e.styles},[Object(i["h"])("div",{class:"__title",onMousedown:t[4]||(t[4]=Object(i["C"])((...t)=>e.startDrag&&e.startDrag(...t),["self","stop"])),onContextmenu:t[5]||(t[5]=Object(i["C"])((...t)=>e.openContextMenu&&e.openContextMenu(...t),["self","prevent"]))},[e.renaming?Object(i["A"])((Object(i["n"])(),Object(i["f"])("input",{key:1,type:"text",class:"dark-input","onUpdate:modelValue":t[1]||(t[1]=t=>e.tempName=t),placeholder:"Node Name",onKeydown:t[2]||(t[2]=Object(i["B"])((...t)=>e.doneRenaming&&e.doneRenaming(...t),["enter"]))},null,544)),[[i["x"],e.tempName],[c,e.doneRenaming]]):(Object(i["n"])(),Object(i["f"])("span",Z,Object(i["v"])(e.node.name),1)),(Object(i["n"])(),Object(i["f"])(Object(i["u"])(e.plugin.components.contextMenu),{modelValue:e.contextMenu.show,"onUpdate:modelValue":t[3]||(t[3]=t=>e.contextMenu.show=t),x:e.contextMenu.x,y:e.contextMenu.y,items:e.contextMenu.items,onClick:e.onContextMenu},null,8,["modelValue","x","y","items","onClick"]))],32),Object(i["h"])("div",Q,[Object(i["h"])("div",ee,[(Object(i["n"])(!0),Object(i["f"])(i["a"],null,Object(i["q"])(e.node.outputInterfaces,(t,n)=>(Object(i["n"])(),Object(i["f"])(Object(i["u"])(e.plugin.components.nodeInterface),{key:t.id,name:n,intf:t},null,8,["name","intf"]))),128))]),Object(i["h"])("div",te,[(Object(i["n"])(!0),Object(i["f"])(i["a"],null,Object(i["q"])(e.node.options,([t,n])=>(Object(i["n"])(),Object(i["f"])(i["a"],{key:t},[(Object(i["n"])(),Object(i["f"])(Object(i["u"])(e.plugin.components.nodeOption),{name:t,option:n,componentName:n.optionComponent,node:e.node,onOpenSidebar:n=>e.openSidebar(t)},null,8,["name","option","componentName","node","onOpenSidebar"])),e.plugin.sidebar.nodeId===e.node.id&&e.plugin.sidebar.optionName===t&&n.sidebarComponent?(Object(i["n"])(),Object(i["f"])(i["b"],{key:"sb_"+t,to:"#sidebar"},[(Object(i["n"])(),Object(i["f"])(Object(i["u"])(e.plugin.components.nodeOption),{key:e.node.id+t,name:t,option:n,componentName:n.sidebarComponent,node:e.node},null,8,["name","option","componentName","node"]))])):Object(i["g"])("",!0)],64))),128))]),Object(i["h"])("div",ne,[(Object(i["n"])(!0),Object(i["f"])(i["a"],null,Object(i["q"])(e.node.inputInterfaces,(t,n)=>(Object(i["n"])(),Object(i["f"])(Object(i["u"])(e.plugin.components.nodeInterface),{key:t.id,name:n,intf:t},null,8,["name","intf"]))),128))])])],14,["id"])}var ie=n("a9e2"),re=n.n(ie);function se(e){return e.replace(" ","-")}var ce=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.draggingStartPosition=null,t.draggingStartPoint=null,t.renaming=!1,t.tempName="",t.contextMenu={show:!1,x:0,y:0,items:[{value:"rename",label:"Rename"},{value:"delete",label:"Delete"}]},t}return Object(c["d"])(t,e),Object.defineProperty(t.prototype,"classes",{get:function(){var e;return e={node:!0,"--selected":this.selected,"--dragging":!!this.draggingStartPoint,"--two-column":!!this.node.twoColumn},e["--type-"+se(this.node.type)]=!0,e[this.node.customClasses]=!0,e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"styles",{get:function(){return{top:this.node.position.y+"px",left:this.node.position.x+"px",width:this.node.width+"px"}},enumerable:!1,configurable:!0}),t.prototype.mounted=function(){var e=this;this.node.events.addInterface.addListener(this,(function(){return e.update()})),this.node.events.removeInterface.addListener(this,(function(){return e.update()})),this.node.events.addOption.addListener(this,(function(){return e.update()})),this.node.events.removeOption.addListener(this,(function(){return e.update()})),this.plugin.hooks.renderNode.execute(this)},t.prototype.updated=function(){this.plugin.hooks.renderNode.execute(this)},t.prototype.beforeDestroy=function(){this.node.events.addInterface.removeListener(this),this.node.events.removeInterface.removeListener(this),this.node.events.addOption.removeListener(this),this.node.events.removeOption.removeListener(this)},t.prototype.update=function(){this.$forceUpdate()},t.prototype.startDrag=function(e){this.select(),0!==this.selectedNodeViews.length&&void 0!==this.selectedNodeViews[0]||(this.selectedNodeViews.splice(0,this.selectedNodeViews.length),this.selectedNodeViews.push(this)),this.selectedNodeViews.forEach((function(t){t.draggingStartPoint={x:e.screenX,y:e.screenY},t.draggingStartPosition={x:t.node.position.x,y:t.node.position.y},document.addEventListener("mousemove",t.handleMove),document.addEventListener("mouseup",t.stopDrag)}))},t.prototype.select=function(){this.$emit("select",this)},t.prototype.stopDrag=function(){this.selectedNodeViews.forEach((function(e){e.draggingStartPoint=null,e.draggingStartPosition=null,document.removeEventListener("mousemove",e.handleMove),document.removeEventListener("mouseup",e.stopDrag)}))},t.prototype.handleMove=function(e){this.selectedNodeViews.forEach((function(t){if(t.draggingStartPoint){var n=e.screenX-t.draggingStartPoint.x,o=e.screenY-t.draggingStartPoint.y;t.node.position.x=t.draggingStartPosition.x+n/t.plugin.scaling,t.node.position.y=t.draggingStartPosition.y+o/t.plugin.scaling}}))},t.prototype.openContextMenu=function(e){this.contextMenu.show=!0,this.contextMenu.x=e.offsetX,this.contextMenu.y=e.offsetY},t.prototype.onContextMenu=function(e){switch(e){case"delete":this.plugin.editor.removeNode(this.node);break;case"rename":this.tempName=this.node.name,this.renaming=!0}},t.prototype.doneRenaming=function(){this.node.name=this.tempName,this.renaming=!1},t.prototype.openSidebar=function(e){this.plugin.sidebar.nodeId=this.node.id,this.plugin.sidebar.optionName=e,this.plugin.sidebar.visible=!0},Object(c["c"])([Object(a["c"])({type:Object})],t.prototype,"node",void 0),Object(c["c"])([Object(a["c"])({type:Boolean,default:!1})],t.prototype,"selected",void 0),Object(c["c"])([Object(a["a"])()],t.prototype,"plugin",void 0),Object(c["c"])([Object(a["a"])()],t.prototype,"selectedNodeViews",void 0),t=Object(c["c"])([Object(a["b"])({directives:{ClickOutside:re.a.directive}})],t),t}(a["e"]),ae=ce;ae.render=oe;var ue=ae;const de={key:0,class:"align-middle"};function pe(e,t,n,o,r,s){return Object(i["n"])(),Object(i["f"])("div",{id:e.intf.id,class:e.classes},[Object(i["h"])("div",{class:"__port",onMouseover:t[1]||(t[1]=(...t)=>e.startHover&&e.startHover(...t)),onMouseout:t[2]||(t[2]=(...t)=>e.endHover&&e.endHover(...t))},null,32),e.intf.connectionCount>0||!e.intf.option||!e.getOptionComponent(e.intf.option)?(Object(i["n"])(),Object(i["f"])("span",de,Object(i["v"])(e.displayName),1)):(Object(i["n"])(),Object(i["f"])(Object(i["u"])(e.getOptionComponent(e.intf.option)),{key:1,option:e.intf,value:e.value,onInput:t[3]||(t[3]=t=>e.intf.value=t),name:e.displayName},null,8,["option","value","name"]))],10,["id"])}var le=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.value=null,t.isConnected=!1,t}return Object(c["d"])(t,e),Object.defineProperty(t.prototype,"classes",{get:function(){return{"node-interface":!0,"--input":this.intf.isInput,"--output":!this.intf.isInput,"--connected":this.isConnected}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"displayName",{get:function(){return this.intf.displayName||this.name},enumerable:!1,configurable:!0}),t.prototype.beforeMount=function(){var e=this;this.value=this.intf.value,this.intf.events.setValue.addListener(this,(function(t){e.value=t})),this.intf.events.setConnectionCount.addListener(this,(function(t){e.$forceUpdate(),e.isConnected=t>0})),this.intf.events.updated.addListener(this,(function(t){e.$forceUpdate()})),this.isConnected=this.intf.connectionCount>0},t.prototype.mounted=function(){this.plugin.hooks.renderInterface.execute(this)},t.prototype.updated=function(){this.plugin.hooks.renderInterface.execute(this)},t.prototype.beforeDestroy=function(){this.intf.events.setValue.removeListener(this),this.intf.events.setConnectionCount.removeListener(this),this.intf.events.updated.removeListener(this)},t.prototype.startHover=function(){this.editor.hoveredOver(this.intf)},t.prototype.endHover=function(){this.editor.hoveredOver(void 0)},t.prototype.getOptionComponent=function(e){if(e&&this.plugin.options)return this.plugin.options[e]},Object(c["c"])([Object(a["c"])({type:Object,default:function(){return{}}})],t.prototype,"intf",void 0),Object(c["c"])([Object(a["c"])({type:String,default:""})],t.prototype,"name",void 0),Object(c["c"])([Object(a["a"])()],t.prototype,"plugin",void 0),Object(c["c"])([Object(a["a"])()],t.prototype,"editor",void 0),t}(a["e"]),he=le;he.render=pe;var fe=he;function ve(e,t,n,o,r,s){return Object(i["n"])(),Object(i["f"])(Object(i["u"])(e.component),{name:e.displayName,class:"node-option",node:e.node,value:e.value,option:e.option,onInput:e.updateValue,onOpenSidebar:t[1]||(t[1]=t=>e.$emit("openSidebar"))},null,8,["name","node","value","option","onInput"])}var be=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.value=null,t}return Object(c["d"])(t,e),Object.defineProperty(t.prototype,"component",{get:function(){if(this.plugin.options&&this.componentName)return this.plugin.options[this.componentName]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"displayName",{get:function(){return this.option.displayName||this.name},enumerable:!1,configurable:!0}),t.prototype.beforeMount=function(){var e=this;this.value=this.option.value,this.option.events.setValue.addListener(this,(function(t){e.value=t}))},t.prototype.mounted=function(){this.plugin.hooks.renderOption.execute(this)},t.prototype.updated=function(){this.plugin.hooks.renderOption.execute(this)},t.prototype.beforeDestroy=function(){this.option.events.setValue.removeListener(this)},t.prototype.updateValue=function(e){this.option.value=e},Object(c["c"])([Object(a["c"])()],t.prototype,"name",void 0),Object(c["c"])([Object(a["c"])()],t.prototype,"option",void 0),Object(c["c"])([Object(a["c"])()],t.prototype,"componentName",void 0),Object(c["c"])([Object(a["c"])()],t.prototype,"node",void 0),Object(c["c"])([Object(a["a"])()],t.prototype,"plugin",void 0),t}(a["e"]),ye=be;ye.render=ve;var me=ye;const Oe={class:"flex-fill"},ge={key:0,class:"ml-3",style:{"line-height":"1em"}},je=Object(i["h"])("svg",{width:"13",height:"13",viewBox:"-60 120 250 250"},[Object(i["h"])("path",{d:"M160.875 279.5625 L70.875 369.5625 L70.875 189.5625 L160.875 279.5625 Z",stroke:"none",fill:"white"})],-1);function xe(e,t,n,o,r,s){const c=Object(i["s"])("context-menu",!0),a=Object(i["t"])("click-outside");return Object(i["A"])((Object(i["n"])(),Object(i["f"])("div",{class:e.classes,style:e.styles},[(Object(i["n"])(!0),Object(i["f"])(i["a"],null,Object(i["q"])(e._items,(t,n)=>(Object(i["n"])(),Object(i["f"])(i["a"],null,[t.isDivider?(Object(i["n"])(),Object(i["f"])("div",{key:"divider-"+n,class:"divider"})):(Object(i["n"])(),Object(i["f"])("div",{key:"item-"+n,class:[{item:!0,submenu:!!t.submenu,"--disabled":!!t.disabled},"d-flex align-items-center"],onMouseenter:t=>e.onMouseEnter(t,n),onMouseleave:t=>e.onMouseLeave(t,n),onClick:Object(i["C"])(n=>e.onClick(t),["stop","prevent"])},[Object(i["h"])("div",Oe,Object(i["v"])(t.label),1),t.submenu?(Object(i["n"])(),Object(i["f"])("div",ge,[je])):Object(i["g"])("",!0),t.submenu?(Object(i["n"])(),Object(i["f"])(c,{key:1,"model-value":e.activeMenu===n,items:t.submenu,"is-nested":!0,"is-flipped":{x:e.flippedX,y:e.flippedY},flippable:e.flippable,onClick:e.onChildClick},null,8,["model-value","items","is-flipped","flippable","onClick"])):Object(i["g"])("",!0)],42,["onMouseenter","onMouseleave","onClick"]))],64))),256))],6)),[[i["y"],e.modelValue],[a,e.onClickOutside]])}var we=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.activeMenu=-1,t.activeMenuResetTimeout=null,t.height=0,t.rootIsFlipped={x:!1,y:!1},t}var n;return Object(c["d"])(t,e),n=t,Object.defineProperty(t.prototype,"styles",{get:function(){var e={};return this.isNested||(e.top=(this.flippedY?this.y-this.height:this.y)+"px",e.left=this.x+"px"),e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"classes",{get:function(){return{"dark-context-menu":!0,"--flipped-x":this.flippedX,"--flipped-y":this.flippedY,"--nested":this.isNested}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_items",{get:function(){return this.items.map((function(e){return Object(c["a"])(Object(c["a"])({},e),{hover:!1})}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"flippedX",{get:function(){return this.flippable&&(this.rootIsFlipped.x||this.isFlipped.x)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"flippedY",{get:function(){return this.flippable&&(this.rootIsFlipped.y||this.isFlipped.y)},enumerable:!1,configurable:!0}),t.prototype.onClick=function(e){!e.submenu&&e.value&&(this.$emit("click",e.value),this.$emit("update:modelValue",!1))},t.prototype.onChildClick=function(e){this.$emit("click",e),this.activeMenu=-1,this.isNested||this.$emit("update:modelValue",!1)},t.prototype.onClickOutside=function(e){this.modelValue&&this.$emit("update:modelValue",!1)},t.prototype.onMouseEnter=function(e,t){this.items[t].submenu&&(this.activeMenu=t,null!==this.activeMenuResetTimeout&&(clearTimeout(this.activeMenuResetTimeout),this.activeMenuResetTimeout=null))},t.prototype.onMouseLeave=function(e,t){var n=this;this.items[t].submenu&&(this.activeMenuResetTimeout=window.setTimeout((function(){n.activeMenu=-1,n.activeMenuResetTimeout=null}),200))},t.prototype.created=function(){this.$options.components?this.$options.components["context-menu"]=n:this.$options.components={"context-menu":n}},t.prototype.updateFlipped=function(){this.height=30*this.items.length;var e=this.$parent.$el.offsetWidth,t=this.$parent.$el.offsetHeight;this.rootIsFlipped.x=!this.isNested&&this.x>.75*e,this.rootIsFlipped.y=!this.isNested&&this.y+this.height>t-20},t.prototype.updateDisabledValues=function(){this.modelValue&&this.items.forEach((function(e){e.disabledFunction&&(e.disabled=e.disabledFunction())}))},Object(c["c"])([Object(a["c"])({type:Boolean,default:!1})],t.prototype,"modelValue",void 0),Object(c["c"])([Object(a["c"])({type:Array,default:function(){return[]}})],t.prototype,"items",void 0),Object(c["c"])([Object(a["c"])({type:Number,default:0})],t.prototype,"x",void 0),Object(c["c"])([Object(a["c"])({type:Number,default:0})],t.prototype,"y",void 0),Object(c["c"])([Object(a["c"])({type:Boolean,default:!1})],t.prototype,"isNested",void 0),Object(c["c"])([Object(a["c"])({type:Object,default:function(){return{x:!1,y:!1}}})],t.prototype,"isFlipped",void 0),Object(c["c"])([Object(a["c"])({type:Boolean,default:!1})],t.prototype,"flippable",void 0),Object(c["c"])([Object(a["f"])("y"),Object(a["f"])("items")],t.prototype,"updateFlipped",null),Object(c["c"])([Object(a["f"])("modelValue",{immediate:!0})],t.prototype,"updateDisabledValues",null),t=n=Object(c["c"])([Object(a["b"])({directives:{ClickOutside:re.a.directive},emits:["update:modelValue","click"]})],t),t}(a["e"]),Ce=we;Ce.render=xe;var Ne=Ce;const ke={class:"d-flex align-items-center"},Ie={class:"ml-2"};function Me(e,t,n,o,r,s){return Object(i["n"])(),Object(i["f"])("div",{id:"sidebar",class:["sidebar",{"--open":e.plugin.sidebar.visible}],style:e.styles},[Object(i["h"])("div",{class:"__resizer",onMousedown:t[1]||(t[1]=(...t)=>e.startResize&&e.startResize(...t))},null,32),Object(i["h"])("div",ke,[Object(i["h"])("button",{tabindex:"-1",class:"__close",onClick:t[2]||(t[2]=(...t)=>e.close&&e.close(...t))},"×"),Object(i["h"])("div",Ie,[Object(i["h"])("b",null,Object(i["v"])(e.nodeName),1)])])],6)}var Se=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.width=300,t}return Object(c["d"])(t,e),Object.defineProperty(t.prototype,"nodeName",{get:function(){var e=this.plugin.sidebar.nodeId,t=this.plugin.editor.nodes.find((function(t){return t.id===e}));return t?t.name:""},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"styles",{get:function(){return{width:this.width+"px"}},enumerable:!1,configurable:!0}),t.prototype.close=function(){this.plugin.sidebar.visible=!1},t.prototype.startResize=function(){var e=this;window.addEventListener("mousemove",this.onMouseMove),window.addEventListener("mouseup",(function(){window.removeEventListener("mousemove",e.onMouseMove)}),{once:!0})},t.prototype.onMouseMove=function(e){var t=this.$parent.$el.getBoundingClientRect().width;this.width-=e.movementX,this.width<300?this.width=300:this.width>.9*t&&(this.width=.9*t)},Object(c["c"])([Object(a["a"])()],t.prototype,"plugin",void 0),t}(a["e"]),Pe=Se;Pe.render=Me;var Ee=Pe;function _e(e,t,n,o,r,s){return Object(i["n"])(),Object(i["f"])("canvas",{ref:"cv",class:"minimap",onMouseenter:t[1]||(t[1]=t=>e.showViewBounds=!0),onMouseleave:t[2]||(t[2]=()=>{this.showViewBounds=!1,this.mouseup()}),onMousedown:t[3]||(t[3]=Object(i["C"])((...t)=>e.mousedown&&e.mousedown(...t),["self"])),onMousemove:t[4]||(t[4]=Object(i["C"])((...t)=>e.mousemove&&e.mousemove(...t),["self"])),onMouseup:t[5]||(t[5]=(...t)=>e.mouseup&&e.mouseup(...t))},null,544)}var Te=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.intervalHandle=0,t.showViewBounds=!1,t.dragging=!1,t.bounds={x1:0,y1:0,x2:0,y2:0},t}return Object(c["d"])(t,e),t.prototype.mounted=function(){var e,t=this,n=this.$refs.cv;this.ctx=null!==(e=n.getContext("2d"))&&void 0!==e?e:void 0,this.ctx&&(this.ctx.imageSmoothingQuality="high"),this.intervalHandle=setInterval((function(){return t.updateCanvas()}),250)},t.prototype.beforeDestroy=function(){clearInterval(this.intervalHandle)},t.prototype.updateCanvas=function(){var e,t,n,o,i,r,s,a,u,d;if(this.ctx){var p=new Map,l=new Map;try{for(var h=Object(c["h"])(this.nodes),f=h.next();!f.done;f=h.next()){var v=f.value,b=H(v),y=null!==(u=null===b||void 0===b?void 0:b.clientWidth)&&void 0!==u?u:0,m=null!==(d=null===b||void 0===b?void 0:b.clientHeight)&&void 0!==d?d:0;p.set(v,{x1:v.position.x,y1:v.position.y,x2:v.position.x+y,y2:v.position.y+m}),l.set(v,b)}}catch(K){e={error:K}}finally{try{f&&!f.done&&(t=h.return)&&t.call(h)}finally{if(e)throw e.error}}var O={x1:Number.MAX_SAFE_INTEGER,y1:Number.MAX_SAFE_INTEGER,x2:Number.MIN_SAFE_INTEGER,y2:Number.MIN_SAFE_INTEGER};try{for(var g=Object(c["h"])(p.values()),j=g.next();!j.done;j=g.next()){var x=j.value;x.x1<O.x1&&(O.x1=x.x1),x.y1<O.y1&&(O.y1=x.y1),x.x2>O.x2&&(O.x2=x.x2),x.y2>O.y2&&(O.y2=x.y2)}}catch(Z){n={error:Z}}finally{try{j&&!j.done&&(o=g.return)&&o.call(g)}finally{if(n)throw n.error}}var w=50;O.x1-=w,O.y1-=w,O.x2+=w,O.y2+=w,this.bounds=O,this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.strokeStyle="white";try{for(var C=Object(c["h"])(this.connections),N=C.next();!N.done;N=C.next()){var k=N.value,I=(F(k.to),Object(c["f"])(W(F(k.from)),2)),M=I[0],S=I[1],P=Object(c["f"])(W(F(k.to)),2),E=P[0],_=P[1],T=Object(c["f"])(this.transformCoordinates(M,S),2),V=T[0],B=T[1],L=Object(c["f"])(this.transformCoordinates(E,_),2),A=L[0],D=L[1];if(this.ctx.beginPath(),this.ctx.moveTo(V,B),this.plugin.useStraightConnections)this.ctx.lineTo(A,D);else{var R=.3*Math.abs(V-A);this.ctx.bezierCurveTo(V+R,B,A-R,D,A,D)}this.ctx.stroke()}}catch(Q){i={error:Q}}finally{try{N&&!N.done&&(r=C.return)&&r.call(C)}finally{if(i)throw i.error}}this.ctx.strokeStyle="lightgray";try{for(var $=Object(c["h"])(p.entries()),z=$.next();!z.done;z=$.next()){var X=Object(c["f"])(z.value,2),q=(v=X[0],x=X[1],Object(c["f"])(this.transformCoordinates(x.x1,x.y1),2)),G=(V=q[0],B=q[1],Object(c["f"])(this.transformCoordinates(x.x2,x.y2),2));A=G[0],D=G[1];this.ctx.fillStyle=this.getNodeColor(l.get(v)),this.ctx.beginPath(),this.ctx.rect(V,B,A-V,D-B),this.ctx.fill(),this.ctx.stroke()}}catch(ee){s={error:ee}}finally{try{z&&!z.done&&(a=$.return)&&a.call($)}finally{if(s)throw s.error}}if(this.showViewBounds){var U=this.getViewBounds(),Y=Object(c["f"])(this.transformCoordinates(U.x1,U.y1),2),J=(V=Y[0],B=Y[1],Object(c["f"])(this.transformCoordinates(U.x2,U.y2),2));A=J[0],D=J[1];this.ctx.fillStyle="rgba(255, 255, 255, 0.2)",this.ctx.fillRect(V,B,A-V,D-B)}}},t.prototype.transformCoordinates=function(e,t){return[(e-this.bounds.x1)/(this.bounds.x2-this.bounds.x1)*this.ctx.canvas.clientWidth,(t-this.bounds.y1)/(this.bounds.y2-this.bounds.y1)*this.ctx.canvas.clientHeight]},t.prototype.reverseTransform=function(e,t){return[e*(this.bounds.x2-this.bounds.x1)/this.ctx.canvas.clientWidth+this.bounds.x1,t*(this.bounds.y2-this.bounds.y1)/this.ctx.canvas.clientHeight+this.bounds.y1]},t.prototype.getNodeColor=function(e){if(e){var t=e.querySelector(".__content");if(t){var n=this.getComputedColor(t);if(n)return n}var o=this.getComputedColor(e);if(o)return o}return"gray"},t.prototype.getComputedColor=function(e){var t=getComputedStyle(e).backgroundColor;if(t&&"rgba(0, 0, 0, 0)"!==t)return t},t.prototype.getViewBounds=function(){var e=this.$parent.$el.offsetWidth,t=this.$parent.$el.offsetHeight,n=e/this.plugin.scaling-this.plugin.panning.x,o=t/this.plugin.scaling-this.plugin.panning.y;return{x1:-this.plugin.panning.x,y1:-this.plugin.panning.y,x2:n,y2:o}},t.prototype.mousedown=function(e){0===e.button&&(this.dragging=!0,this.mousemove(e))},t.prototype.mousemove=function(e){if(this.dragging){var t=Object(c["f"])(this.reverseTransform(e.offsetX,e.offsetY),2),n=t[0],o=t[1],i=this.getViewBounds(),r=(i.x1-i.x2)/2,s=(i.y1-i.y2)/2;this.plugin.panning.x=-(n+r),this.plugin.panning.y=-(o+s)}},t.prototype.mouseup=function(e){this.dragging=!1},Object(c["c"])([Object(a["c"])()],t.prototype,"nodes",void 0),Object(c["c"])([Object(a["c"])()],t.prototype,"connections",void 0),Object(c["c"])([Object(a["a"])()],t.prototype,"plugin",void 0),Object(c["c"])([Object(a["f"])("showViewBounds"),Object(a["f"])("plugin.panning.x"),Object(a["f"])("plugin.panning.y"),Object(a["f"])("plugin.scaling")],t.prototype,"updateCanvas",null),t}(a["e"]),Ve=Te;Ve.render=_e;var Be=Ve,Le={install:function(e){e.component("baklava-editor",V)}},Ae=Le,De=function(){function e(){this.type="ViewPlugin",this.panning={x:0,y:0},this.scaling=1,this.sidebar={visible:!1,nodeId:"",optionName:""},this.useStraightConnections=!1,this.enableMinimap=!1,this.backgroundGrid={gridSize:100,gridDivision:5,subGridVisibleThreshold:.6},this.options={},this.nodeTypeAliases={},this.hooks={renderNode:new p["SequentialHook"],renderOption:new p["SequentialHook"],renderInterface:new p["SequentialHook"],renderConnection:new p["SequentialHook"]},this.components={node:Object(i["l"])(ue),nodeOption:Object(i["l"])(me),nodeInterface:Object(i["l"])(fe),connection:Object(i["l"])(G),tempConnection:Object(i["l"])(K),contextMenu:Object(i["l"])(Ne),sidebar:Object(i["l"])(Ee),minimap:Object(i["l"])(Be)}}return e.prototype.register=function(e){var t=this;this.editor=e,this.editor.hooks.load.tap(this,(function(e){return t.panning=e.panning,t.scaling=e.scaling,e})),this.editor.hooks.save.tap(this,(function(e){return e.panning=t.panning,e.scaling=t.scaling,e})),this.editor.events.beforeAddNode.addListener(this,(function(e){var n=e;n.position={x:0,y:0},n.disablePointerEvents=!1,n.twoColumn=n.twoColumn||!1,n.width=n.width||200,n.customClasses=n.customClasses||"",e.hooks.save.tap(t,(function(e){return e.position=n.position,e.width=n.width,e.twoColumn=n.twoColumn,e.customClasses=n.customClasses,e})),e.hooks.load.tap(t,(function(e){return n.position=e.position||{x:0,y:0},n.width=e.width||200,n.twoColumn=e.twoColumn||!1,e}))}))},e.prototype.registerOption=function(e,t){this.options[e]=Object(i["l"])(t)},e.prototype.setNodeTypeAlias=function(e,t){t?this.nodeTypeAliases[e]=t:this.nodeTypeAliases[e]&&delete this.nodeTypeAliases[e]},e}(),Re={Connection:D,ConnectionWrapper:G,TemporaryConnection:K,Node:ue,NodeInterface:fe,NodeOption:me,ContextMenu:Ne,Sidebar:Ee,Minimap:Be},$e=n("80a2"),He=function(e){return[Object,Array].includes((e||{}).constructor)&&!Object.entries(e||{}).length};function Fe(e,t,n){var o=new Map;e.forEach((function(e){o.set(e,t.filter((function(t){return t.to&&t.to.parent===e})).map((function(e){return e.from.parent})))}));var i=n||e.filter((function(e){return He(e.outputInterfaces)})),r={children:i.map((function(e){return{n:e,children:[]}}))};ze(r,[],o);var s=[],c=[];s.push(r);while(s.length>0){var a=s.shift();a.children.forEach((function(e){c.push(e.n),s.push(e)}))}var u=[];while(c.length>0){var d=c.pop();u.includes(d)||u.push(d)}return{calculationOrder:u,rootNodes:i}}function ze(e,t,n){var o,i;try{for(var r=Object(c["h"])(e.children),s=r.next();!s.done;s=r.next()){var a=s.value;if(t.includes(a.n))throw new Error("Cycle detected");t.unshift(a.n),a.children=a.children.concat(n.get(a.n).map((function(e){return{n:e,children:new Array}}))),ze(a,t,n),t.shift()}}catch(u){o={error:u}}finally{try{s&&!s.done&&(i=r.return)&&i.call(r)}finally{if(o)throw o.error}}}function Xe(e,t){try{return Fe(e,t),!0}catch(n){return!1}}var qe=function(){function e(e){void 0===e&&(e=!1),this.type="EnginePlugin",this.events={beforeCalculate:new p["PreventableBaklavaEvent"],calculated:new p["BaklavaEvent"]},this.hooks={gatherCalculationData:new p["SequentialHook"]},this.nodeCalculationOrder=[],this.actualRootNodes=[],this.connectionsPerNode=new Map,this.recalculateOrder=!1,this.calculateOnChange=!1,this.calculationInProgress=!1,this.mutex=new $e["a"],this._rootNodes=void 0,this.interfaceTypePlugins=[],this.calculateOnChange=e}return Object.defineProperty(e.prototype,"rootNodes",{get:function(){return this._rootNodes},set:function(e){this._rootNodes=e,this.recalculateOrder=!0},enumerable:!1,configurable:!0}),e.prototype.register=function(e){var t=this;this.editor=e,this.editor.plugins.forEach((function(e){"InterfaceTypePlugin"===e.type&&t.interfaceTypePlugins.push(e)})),this.editor.events.usePlugin.addListener(this,(function(e){"InterfaceTypePlugin"===e.type&&t.interfaceTypePlugins.push(e)})),this.editor.events.addNode.addListener(this,(function(e){e.events.update.addListener(t,(function(e){(e.interface&&0===e.interface.connectionCount||e.option)&&t.onChange(!1)})),t.onChange(!0)})),this.editor.events.removeNode.addListener(this,(function(e){e.events.update.removeListener(t)})),this.editor.events.checkConnection.addListener(this,(function(e){if(!t.checkConnection(e.from,e.to))return!1})),this.editor.events.addConnection.addListener(this,(function(e){t.editor.connections.filter((function(t){return t.id!==e.id&&t.to===e.to})).forEach((function(e){return t.editor.removeConnection(e)})),t.onChange(!0)})),this.editor.events.removeConnection.addListener(this,(function(){t.onChange(!0)}))},e.prototype.calculate=function(e){return Object(c["b"])(this,void 0,Promise,(function(){var t=this;return Object(c["e"])(this,(function(n){switch(n.label){case 0:return[4,this.mutex.runExclusive((function(){return Object(c["b"])(t,void 0,void 0,(function(){return Object(c["e"])(this,(function(t){switch(t.label){case 0:return[4,this.internalCalculate(e)];case 1:return[2,t.sent()]}}))}))}))];case 1:return[2,n.sent()]}}))}))},e.prototype.calculateOrder=function(){this.calculateNodeTree(),this.recalculateOrder=!1},e.prototype.internalCalculate=function(e){return Object(c["b"])(this,void 0,Promise,(function(){var t,n,o,i,r,s,a,u,d=this;return Object(c["e"])(this,(function(p){switch(p.label){case 0:if(this.events.beforeCalculate.emit(e))return[2,null];e=this.hooks.gatherCalculationData.execute(e),this.calculationInProgress=!0,this.recalculateOrder&&this.calculateOrder(),t=new Map,p.label=1;case 1:p.trys.push([1,6,7,8]),n=Object(c["h"])(this.nodeCalculationOrder),o=n.next(),p.label=2;case 2:return o.done?[3,5]:(i=o.value,[4,i.calculate(e)]);case 3:r=p.sent(),this.actualRootNodes.includes(i)&&t.set(i,r),this.connectionsPerNode.has(i)&&this.connectionsPerNode.get(i).forEach((function(e){var t=d.interfaceTypePlugins.find((function(t){return t.canConvert(e.from.type,e.to.type)}));e.to.value=t?t.convert(e.from.type,e.to.type,e.from.value):e.from.value})),p.label=4;case 4:return o=n.next(),[3,2];case 5:return[3,8];case 6:return s=p.sent(),a={error:s},[3,8];case 7:try{o&&!o.done&&(u=n.return)&&u.call(n)}finally{if(a)throw a.error}return[7];case 8:return this.calculationInProgress=!1,this.events.calculated.emit(t),[2,t]}}))}))},e.prototype.checkConnection=function(e,t){var n={from:e,to:t,id:"dc",destructed:!1,isInDanger:!1},o=this.editor.connections.concat([n]);return o.filter((function(e){return e.to!==t})),Xe(this.editor.nodes,o)},e.prototype.onChange=function(e){this.recalculateOrder=this.recalculateOrder||e,this.calculateOnChange&&!this.calculationInProgress&&this.calculate()},e.prototype.calculateNodeTree=function(){var e=this,t=Fe(this.editor.nodes,this.editor.connections,this.rootNodes),n=t.calculationOrder,o=t.rootNodes;this.nodeCalculationOrder=n,this.actualRootNodes=o,this.connectionsPerNode.clear(),this.editor.nodes.forEach((function(t){e.connectionsPerNode.set(t,e.editor.connections.filter((function(e){return e.from.parent===t})))}))},e}(),Ge=function(){function e(){this.type="InterfaceTypePlugin",this.types=new Map}return e.prototype.register=function(e){var t=this;this.editor=e,this.editor.plugins.forEach((function(e){"ViewPlugin"===e.type&&t.registerView(e)})),this.editor.events.checkConnection.addListener(this,(function(e){var n=e.from,o=e.to,i=n.type,r=o.type;if(i&&r)return!!t.canConvert(i,r)&&void 0})),this.editor.events.usePlugin.addListener(this,(function(e){"ViewPlugin"===e.type&&t.registerView(e)}))},e.prototype.addType=function(e,t){return this.types.set(e,{color:t,conversions:[]}),this},e.prototype.addConversion=function(e,t,n){if(!this.types.has(e))throw new Error('Can not add conversion for unknown type "'+e+'"');return n||(n=function(e){return e}),this.types.get(e).conversions.push({targetType:t,transformationFunction:n}),this},e.prototype.getConversion=function(e,t){return this.types.has(e)&&this.types.get(e).conversions.find((function(e){return e.targetType===t}))},e.prototype.canConvert=function(e,t){return e===t||this.types.has(e)&&this.types.get(e).conversions.some((function(e){return e.targetType===t}))},e.prototype.convert=function(e,t,n){if(e===t)return n;var o=this.getConversion(e,t);if(o)return o.transformationFunction(n);throw Error('Can not convert from "'+e+'" to "'+t+'"')},e.prototype.registerView=function(e){var t=this;e.hooks.renderInterface.tap(this,(function(e){if(t.types.has(e.intf.type)){var n=t.types.get(e.intf.type).color,o=e.$el.getElementsByClassName("__port");Array.from(o).forEach((function(t){t.classList.add("__port-"+e.intf.type),t.style.backgroundColor=n}))}return e}))},e}();function Ue(e,t,n,o,r,s){return Object(i["n"])(),Object(i["f"])("button",{onClick:t[1]||(t[1]=t=>e.$emit("openSidebar")),class:"dark-button --block"},Object(i["v"])(e.name),1)}var We=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(c["d"])(t,e),Object(c["c"])([Object(a["c"])({type:String})],t.prototype,"name",void 0),t=Object(c["c"])([Object(a["b"])({emits:["openSidebar"]})],t),t}(a["e"]),Ye=We;Ye.render=Ue;var Je=Ye;const Ke=Object(i["h"])("div",{class:"__checkmark-container"},[Object(i["h"])("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 18 18"},[Object(i["h"])("path",{class:"__checkmark",d:"M 6 5 L 6 10 L 16 10",transform:"rotate(-45 10 10)"})])],-1),Ze={class:"ml-2"};function Qe(e,t,n,o,r,s){return Object(i["n"])(),Object(i["f"])("div",{onClick:t[1]||(t[1]=t=>e.$emit("input",!e.value)),class:{"dark-checkbox":!0,"--checked":e.value}},[Ke,Object(i["h"])("div",Ze,Object(i["v"])(e.name),1)],2)}var et=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(c["d"])(t,e),Object(c["c"])([Object(a["c"])({type:Boolean})],t.prototype,"value",void 0),Object(c["c"])([Object(a["c"])({type:String})],t.prototype,"name",void 0),t=Object(c["c"])([Object(a["b"])({emits:["input"]})],t),t}(a["e"]),tt=et;tt.render=Qe;var nt=tt;function ot(e,t,n,o,r,s){return Object(i["n"])(),Object(i["f"])("div",null,[Object(i["h"])("input",Object(i["m"])({type:"text",class:"dark-input",value:e.value},Object(i["w"])(e.listeners),{placeholder:e.name}),null,16,["value","placeholder"])])}var it=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(c["d"])(t,e),Object.defineProperty(t.prototype,"listeners",{get:function(){var e=this;return Object(c["a"])(Object(c["a"])({},this.listeners),{input:function(t){return e.$emit("input",t.target.value)}})},enumerable:!1,configurable:!0}),Object(c["c"])([Object(a["c"])({type:String,default:""})],t.prototype,"value",void 0),Object(c["c"])([Object(a["c"])({type:String})],t.prototype,"name",void 0),t=Object(c["c"])([Object(a["b"])({emits:["input"]})],t),t}(a["e"]),rt=it;rt.render=ot;var st=rt;const ct={class:"dark-num-input"},at={class:"__label .text-truncate"},ut={class:"__value"},dt={key:1,class:"__content"};function pt(e,t,n,o,r,s){const c=Object(i["s"])("i-arrow");return Object(i["n"])(),Object(i["f"])("div",ct,[Object(i["h"])("div",{onClick:t[1]||(t[1]=(...t)=>e.decrement&&e.decrement(...t)),class:"__button --dec"},[Object(i["h"])(c)]),e.editMode?(Object(i["n"])(),Object(i["f"])("div",dt,[Object(i["A"])(Object(i["h"])("input",{type:"number","onUpdate:modelValue":t[3]||(t[3]=t=>e.tempValue=t),ref:"input",onBlur:t[4]||(t[4]=(...t)=>e.leaveEditMode&&e.leaveEditMode(...t))},null,544),[[i["x"],e.tempValue]])])):(Object(i["n"])(),Object(i["f"])("div",{key:0,class:"__content",onClick:t[2]||(t[2]=(...t)=>e.enterEditMode&&e.enterEditMode(...t))},[Object(i["h"])("div",at,Object(i["v"])(e.name),1),Object(i["h"])("div",ut,Object(i["v"])(e.stringRepresentation),1)])),Object(i["h"])("div",{onClick:t[5]||(t[5]=(...t)=>e.increment&&e.increment(...t)),class:"__button --inc"},[Object(i["h"])(c)])])}const lt={xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},ht=Object(i["h"])("path",{d:"M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"},null,-1);function ft(e,t,n,o,r,s){return Object(i["n"])(),Object(i["f"])("svg",lt,[ht])}var vt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(c["d"])(t,e),t}(a["e"]),bt=vt;bt.render=ft;var yt=bt,mt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.MAX_STRING_LENGTH=9,t.editMode=!1,t.invalid=!1,t.tempValue="0",t}return Object(c["d"])(t,e),Object.defineProperty(t.prototype,"v",{get:function(){return"string"===typeof this.value?parseFloat(this.value):"number"===typeof this.value?this.value:0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"stringRepresentation",{get:function(){var e=this.v.toFixed(3);return e.length>this.MAX_STRING_LENGTH?this.v.toExponential(this.MAX_STRING_LENGTH-5):e},enumerable:!1,configurable:!0}),t.prototype.setValue=function(e){this.validate(e)&&this.$emit("input",e)},t.prototype.resetInvalid=function(){this.invalid=!1},t.prototype.enterEditMode=function(){return Object(c["b"])(this,void 0,void 0,(function(){return Object(c["e"])(this,(function(e){switch(e.label){case 0:return this.tempValue=this.v.toFixed(3),this.editMode=!0,[4,this.$nextTick()];case 1:return e.sent(),this.$refs.input.focus(),[2]}}))}))},t.prototype.leaveEditMode=function(){var e=parseFloat(this.tempValue);this.validate(e)?(this.$emit("input",e),this.editMode=!1):this.invalid=!0},t.prototype.validate=function(e){return!Number.isNaN(e)&&(!("number"===typeof this.option.min&&e<this.option.min)&&!("number"===typeof this.option.max&&e>this.option.max))},Object(c["c"])([Object(a["c"])()],t.prototype,"value",void 0),Object(c["c"])([Object(a["c"])({type:String})],t.prototype,"name",void 0),Object(c["c"])([Object(a["c"])({type:Object})],t.prototype,"option",void 0),Object(c["c"])([Object(a["f"])("tempValue")],t.prototype,"resetInvalid",null),t}(a["e"]),Ot=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(c["d"])(t,e),Object.defineProperty(t.prototype,"v",{get:function(){return"string"===typeof this.value?parseInt(this.value,10):"number"===typeof this.value?Math.floor(this.value):0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"stringRepresentation",{get:function(){var e=this.v.toString();return e.length>this.MAX_STRING_LENGTH?this.v.toExponential(this.MAX_STRING_LENGTH-5):e},enumerable:!1,configurable:!0}),t.prototype.increment=function(){this.setValue(this.v+1)},t.prototype.decrement=function(){this.setValue(this.v-1)},t.prototype.leaveEditMode=function(){var e=parseInt(this.tempValue,10);this.validate(e)?(this.$emit("input",e),this.editMode=!1):this.invalid=!0},t=Object(c["c"])([Object(a["b"])({components:{"i-arrow":yt},emits:["input"]})],t),t}(mt),gt=Ot;gt.render=pt;var jt=gt;const xt={class:"dark-num-input"},wt={class:"__label .text-truncate"},Ct={class:"__value"},Nt={key:1,class:"__content"};function kt(e,t,n,o,r,s){const c=Object(i["s"])("i-arrow");return Object(i["n"])(),Object(i["f"])("div",xt,[Object(i["h"])("div",{onClick:t[1]||(t[1]=(...t)=>e.decrement&&e.decrement(...t)),class:"__button --dec"},[Object(i["h"])(c)]),e.editMode?(Object(i["n"])(),Object(i["f"])("div",Nt,[Object(i["A"])(Object(i["h"])("input",{type:"number","onUpdate:modelValue":t[3]||(t[3]=t=>e.tempValue=t),class:["dark-input",{"--invalid":e.invalid}],ref:"input",onBlur:t[4]||(t[4]=(...t)=>e.leaveEditMode&&e.leaveEditMode(...t)),onKeydown:t[5]||(t[5]=Object(i["B"])((...t)=>e.leaveEditMode&&e.leaveEditMode(...t),["enter"])),style:{"text-align":"right"}},null,34),[[i["x"],e.tempValue]])])):(Object(i["n"])(),Object(i["f"])("div",{key:0,class:"__content",onClick:t[2]||(t[2]=(...t)=>e.enterEditMode&&e.enterEditMode(...t))},[Object(i["h"])("div",wt,Object(i["v"])(e.name),1),Object(i["h"])("div",Ct,Object(i["v"])(e.stringRepresentation),1)])),Object(i["h"])("div",{onClick:t[6]||(t[6]=(...t)=>e.increment&&e.increment(...t)),class:"__button --inc"},[Object(i["h"])(c)])])}var It=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(c["d"])(t,e),t.prototype.increment=function(){this.setValue(this.v+.1)},t.prototype.decrement=function(){this.setValue(this.v-.1)},t=Object(c["c"])([Object(a["b"])({components:{"i-arrow":yt},emits:["input"]})],t),t}(mt),Mt=It;Mt.render=kt;var St=Mt;const Pt={class:"__selected"},Et={class:"__text"},_t={class:"__icon"},Tt={class:"__dropdown"},Vt={class:"item --header"};function Bt(e,t,n,o,r,s){const c=Object(i["s"])("i-arrow"),a=Object(i["t"])("click-outside");return Object(i["A"])((Object(i["n"])(),Object(i["f"])("div",{class:["dark-select",{"--open":e.open}],onClick:t[1]||(t[1]=t=>e.open=!e.open)},[Object(i["h"])("div",Pt,[Object(i["h"])("div",Et,Object(i["v"])(e.selectedText),1),Object(i["h"])("div",_t,[Object(i["h"])(c)])]),Object(i["h"])(i["c"],{name:"slide-fade"},{default:Object(i["z"])(()=>[Object(i["A"])(Object(i["h"])("div",Tt,[Object(i["h"])("div",Vt,Object(i["v"])(e.name),1),(Object(i["n"])(!0),Object(i["f"])(i["a"],null,Object(i["q"])(e.items,(t,n)=>(Object(i["n"])(),Object(i["f"])("div",{key:n,class:["item",{"--active":e.isSelected(t)}],onClick:n=>e.setSelected(t)},Object(i["v"])(e.getItemText(t)),11,["onClick"]))),128))],512),[[i["y"],e.open]])]),_:1})],2)),[[a,()=>{e.open=!1}]])}var Lt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.open=!1,t.items=[],t}return Object(c["d"])(t,e),Object.defineProperty(t.prototype,"isAdvancedMode",{get:function(){return!this.items.every((function(e){return"string"===typeof e}))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectedText",{get:function(){var e,t;return this.value?this.isAdvancedMode?null!==(t=null===(e=this.getItemByValue(this.value))||void 0===e?void 0:e.text)&&void 0!==t?t:"":this.value:""},enumerable:!1,configurable:!0}),t.prototype.mounted=function(){var e=this;this.items=this.option.items||[],this.option.events.updated.addListener(this,(function(){e.items=e.option.items||[]}))},t.prototype.beforeDestroy=function(){this.option.events.updated.removeListener(this)},t.prototype.isSelected=function(e){return this.isAdvancedMode?e.value===this.value:e===this.value},t.prototype.setSelected=function(e){this.$emit("input",this.isAdvancedMode?e.value:e)},t.prototype.getItemByValue=function(e){return this.items.find((function(t){return t.value===e}))},t.prototype.getItemText=function(e){return this.isAdvancedMode?e.text:e},Object(c["c"])([Object(a["c"])({type:String})],t.prototype,"name",void 0),Object(c["c"])([Object(a["c"])()],t.prototype,"value",void 0),Object(c["c"])([Object(a["c"])({type:Object})],t.prototype,"option",void 0),t=Object(c["c"])([Object(a["b"])({components:{"i-arrow":yt},directives:{ClickOutside:re.a.directive},emits:["input"]})],t),t}(a["e"]),At=Lt;At.render=Bt;var Dt=At;const Rt={key:0,class:"__content"},$t={class:"__label"},Ht={class:"__value"},Ft={key:1,class:"__content"};function zt(e,t,n,o,r,s){return Object(i["n"])(),Object(i["f"])("div",{class:["dark-slider",{"ignore-mouse":!e.editMode}],onMousedown:t[4]||(t[4]=(...t)=>e.mousedown&&e.mousedown(...t)),onMouseup:t[5]||(t[5]=(...t)=>e.mouseup&&e.mouseup(...t)),onMousemove:t[6]||(t[6]=(...t)=>e.mousemove&&e.mousemove(...t)),onMouseleave:t[7]||(t[7]=(...t)=>e.mouseleave&&e.mouseleave(...t))},[Object(i["h"])("div",{class:"__slider",style:{width:e.percentage+"%"}},null,4),e.editMode?(Object(i["n"])(),Object(i["f"])("div",Ft,[Object(i["A"])(Object(i["h"])("input",{type:"number","onUpdate:modelValue":t[1]||(t[1]=t=>e.tempValue=t),class:["dark-input",{"--invalid":e.invalid}],ref:"input",onBlur:t[2]||(t[2]=(...t)=>e.leaveEditMode&&e.leaveEditMode(...t)),onKeydown:t[3]||(t[3]=Object(i["B"])((...t)=>e.leaveEditMode&&e.leaveEditMode(...t),["enter"])),style:{"text-align":"right"}},null,34),[[i["x"],e.tempValue]])])):(Object(i["n"])(),Object(i["f"])("div",Rt,[Object(i["h"])("div",$t,Object(i["v"])(e.name),1),Object(i["h"])("div",Ht,Object(i["v"])(e.stringRepresentation),1)]))],34)}var Xt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.didSlide=!1,t.isMouseDown=!1,t}return Object(c["d"])(t,e),Object.defineProperty(t.prototype,"min",{get:function(){return this.option.min||0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"max",{get:function(){return this.option.max||1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"percentage",{get:function(){return Math.min(100,Math.max(0,100*this.v/(this.max-this.min)))},enumerable:!1,configurable:!0}),t.prototype.mousedown=function(){this.editMode||(this.isMouseDown=!0)},t.prototype.mouseup=function(){this.editMode||(this.didSlide||this.enterEditMode(),this.isMouseDown=!1,this.didSlide=!1)},t.prototype.mouseleave=function(e){this.editMode||(this.isMouseDown&&(e.offsetX>=this.$el.clientWidth?this.$emit("input",this.max):e.offsetX<=0&&this.$emit("input",this.min)),this.isMouseDown=!1,this.didSlide=!1)},t.prototype.mousemove=function(e){if(!this.editMode){var t=Math.max(this.min,Math.min(this.max,(this.max-this.min)*(e.offsetX/this.$el.clientWidth)+this.min));this.isMouseDown&&(this.$emit("input",t),this.didSlide=!0)}},t=Object(c["c"])([Object(a["b"])({emits:["input"]})],t),t}(mt),qt=Xt;qt.render=zt;var Gt=qt;function Ut(e,t,n,o,r,s){return Object(i["n"])(),Object(i["f"])("div",null,Object(i["v"])(e.sanitized),1)}var Wt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(c["d"])(t,e),Object.defineProperty(t.prototype,"sanitized",{get:function(){return String(this.value)},enumerable:!1,configurable:!0}),Object(c["c"])([Object(a["c"])({default:""})],t.prototype,"value",void 0),t}(a["e"]),Yt=Wt;Yt.render=Ut;var Jt=Yt,Kt=function(){function e(){this.type="OptionPlugin"}return e.prototype.register=function(e){var t=this;e.events.usePlugin.addListener(this,(function(e){"ViewPlugin"===e.type&&t.registerOptions(e)})),e.plugins.forEach((function(e){"ViewPlugin"===e.type&&t.registerOptions(e)}))},e.prototype.registerOptions=function(e){Object.entries(o).forEach((function(t){var n=Object(c["f"])(t,2),o=n[0],i=n[1];e.registerOption(o,i)}))},e}();const Zt=Object(i["h"])("textarea",{rows:"6",cols:"20"},null,-1);function Qt(e,t,n,o,r,s){return Object(i["n"])(),Object(i["f"])("div",{id:e.node.id,style:e.styles,onMousedown:t[1]||(t[1]=(...t)=>e.startDrag&&e.startDrag(...t))},[Zt],44,["id"])}var en=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.dragging=!1,t.width=200,t}return Object(c["d"])(t,e),Object.defineProperty(t.prototype,"styles",{get:function(){return{position:"absolute",top:this.node.position.y+"px",left:this.node.position.x+"px",width:this.width+"px",height:"200px","background-color":"yellow"}},enumerable:!1,configurable:!0}),t.prototype.update=function(){this.$forceUpdate()},t.prototype.startDrag=function(){this.dragging=!0,document.addEventListener("mousemove",this.handleMove),document.addEventListener("mouseup",this.stopDrag),this.select()},t.prototype.select=function(){this.$emit("select",this)},t.prototype.stopDrag=function(){this.dragging=!1,document.removeEventListener("mousemove",this.handleMove),document.removeEventListener("mouseup",this.stopDrag)},t.prototype.handleMove=function(e){if(this.dragging){var t=this.plugin.scaling*window.devicePixelRatio;this.node.position.x+=e.movementX/t,this.node.position.y+=e.movementY/t}},Object(c["c"])([Object(a["c"])({type:Object})],t.prototype,"node",void 0),Object(c["c"])([Object(a["c"])({type:Boolean,default:!1})],t.prototype,"selected",void 0),Object(c["c"])([Object(a["a"])()],t.prototype,"plugin",void 0),t}(a["e"]),tn=en;tn.render=Qt;var nn=tn,on=Object(i["i"])({functional:!0,props:{node:{type:Object,required:!0}},render:function(){var e=this,t=function(){var t=e.$props.node;return"CommentNode"===t.type?nn:Re.Node};return Object(i["j"])(t(),this.$props)}}),rn=function(e){function t(){var t=e.call(this)||this;return t.type="TestNode",t.name=t.type,t.registerCalled=!1,t.addInputInterface("Input","CheckboxOption",!1,{type:"boolean"}),t.addInputInterface("Test","NumberOption",5,{type:"number"}),t.addOutputInterface("Output",{type:"boolean"}),t.addOption("test","InputOption"),t.addOption("Select","SelectOption","Test1",void 0,{items:["Test1","Test2","Test3"]}),t.addOption("This is a checkbox","CheckboxOption",!0),t.addOption("Number","NumberOption",5,void 0,{min:0,max:10}),t.addOption("Slider","SliderOption",.5,void 0,{min:0,max:1}),t}return Object(c["d"])(t,e),t.prototype.registerEditor=function(t){e.prototype.registerEditor.call(this,t),this.registerCalled=!0},t.prototype.calculate=function(){this.getInterface("Output").value=this.getInterface("Input").value},t}(y),sn=rn,cn=function(e){function t(){var t=e.call(this)||this;return t.type="OutputNode",t.name=t.type,t.addInputInterface("Input","InputOption"),t.addInputInterface("BooleanInput","CheckboxOption"),t.addOption("output","TextOption"),t.addOption("data","TextOption"),t}return Object(c["d"])(t,e),t.prototype.calculate=function(e){return this.setOptionValue("output",this.getInterface("Input").value),this.setOptionValue("data",e),{test:!0}},t}(y),an=cn,un=new g("BuilderTestNode",{twoColumn:!0,width:400}).addInputInterface("Input 1","InputOption","default1").addInputInterface("Input 2","InputOption","default2").addOption("Separator","InputOption",",").addOption("SidebarTest","TriggerOption",(function(){return{testtext:"this is a test"}}),"SidebarOption").addOutputInterface("Output").onCalculate((function(e){var t=e.getInterface("Input 1").value,n=e.getInterface("Input 2").value,o=e.getOptionValue("Separator");e.getInterface("Output").value=t+o+n})).build(),dn=new g("MathNode").addInputInterface("Number 1","NumberOption",1,{displayName:"Number"}).addInputInterface("Number 2","NumberOption",10,{displayName:"Number"}).addOption("Operation","SelectOption","Add",void 0,{items:["Add","Subtract"]}).addOutputInterface("Output").onCalculate((function(e,t){var n,o=e.getInterface("Number 1").value,i=e.getInterface("Number 2").value,r=e.getOptionValue("Operation").selected;"Add"===r?n=o+i:"Subtract"===r&&(n=o-i),e.getInterface("Output").value=n})).build(),pn=function(e){function t(){var t=e.call(this)||this;return t.type="AdvancedNode",t.name=t.type,t.counter=0,t.addOption("Add Input","AddOption"),t.addOption("Remove Input","AddOption"),t}return Object(c["d"])(t,e),t.prototype.load=function(t){var n=this;t.interfaces.forEach((function(e){var t=Object(c["f"])(e,2),o=t[0],i=t[1],r=n.addInputInterface(o);r.id=i.id})),this.counter=t.interfaces.length,e.prototype.load.call(this,t)},t.prototype.action=function(e){"Add Input"===e?this.addInputInterface("Input "+ ++this.counter):"Remove Input"===e&&this.counter>0&&this.removeInterface("Input "+this.counter--)},t}(y),ln=pn,hn=new g("CommentNode").build(),fn=function(e){function t(){var t=e.call(this)||this;return t.type="OptionTestNode",t.name=t.type,t.addOption("ButtonOption","ButtonOption"),t.addOption("CheckboxOption","CheckboxOption"),t.addOption("InputOption","InputOption"),t.addOption("IntegerOption","IntegerOption",5,void 0,{min:0,max:10}),t.addOption("NumberOption","NumberOption",.5,void 0,{min:0,max:1}),t.addOption("SelectOption","SelectOption","Value 1",void 0,{items:["Value 1","Value 2","Value 3"]}),t.addOption("SliderOption","SliderOption",.5),t.addOption("TextOption","TextOption","My text"),t}return Object(c["d"])(t,e),t}(y),vn=fn,bn=new g("SelectTestNode").addOption("Simple","SelectOption","A",void 0,{items:["A","B","C"]}).addOption("Advanced","SelectOption",3,void 0,{items:[{text:"This is a very long text that should overflow ",value:1},{text:"Y",value:2},{text:"Z",value:3}]}).addOutputInterface("Simple").addOutputInterface("Advanced").onCalculate((function(e){e.getInterface("Simple").value=e.getOptionValue("Simple"),e.getInterface("Advanced").value=e.getOptionValue("Advanced")})).build(),yn=function(e){function t(){var t=e.call(this)||this;t.type="SplitterNode",t.name="Splitter",t.addInputInterface("Source");var n=t.addOption("NrOutputs","SelectOption","4",void 0,{items:["2","4","6","8","16"]});return n.events.setValue.addListener(t,(function(){t.updateOutputs()})),t.updateOutputs(),t}return Object(c["d"])(t,e),t.prototype.load=function(t){var n=this;t.interfaces.forEach((function(e){var t=Object(c["f"])(e,2),o=t[0],i=t[1];if(o.startsWith("Output")){var r=n.addOutputInterface(o);r.id=i.id}})),e.prototype.load.call(this,t)},t.prototype.updateOutputs=function(){var e=parseInt(this.getOptionValue("NrOutputs"),10),t=Object.keys(this.outputInterfaces);if(t.length>e)for(var n=e+1;n<=t.length;n++)this.removeInterface("Output "+n);else if(t.length<e)for(n=t.length+1;n<=e;n++)this.addOutputInterface("Output "+n)},t}(y),mn=yn;function On(e,t,n,o,r,s){return Object(i["n"])(),Object(i["f"])("button",{onClick:t[1]||(t[1]=(...t)=>e.onClick&&e.onClick(...t))},Object(i["v"])(e.name),1)}var gn=Object(i["i"])({props:{name:{type:String,required:!0},node:{type:Object,required:!0}},setup:function(e){var t=function(){e.node.action(e.name)};return{onClick:t}}});gn.render=On;var jn=gn;function xn(e,t,n,o,r,s){const c=Object(i["s"])("button-option");return Object(i["n"])(),Object(i["f"])("div",null,[Object(i["h"])(c,{name:"Test Sidebar",onOpenSidebar:t[1]||(t[1]=t=>e.$emit("openSidebar"))}),Object(i["h"])("p",null,Object(i["v"])(e.value.testtext),1)])}var wn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(c["d"])(t,e),Object(c["c"])([Object(a["c"])()],t.prototype,"value",void 0),t=Object(c["c"])([Object(a["b"])({components:{ButtonOption:Je}})],t),t}(a["e"]),Cn=wn;Cn.render=xn;var Nn=Cn;const kn=Object(i["h"])("h1",null,"Sidebar Option",-1),In=Object(i["h"])("p",null,"This is an advanced option",-1);function Mn(e,t,n,o,r,s){const c=Object(i["s"])("input-option");return Object(i["n"])(),Object(i["f"])("div",null,[kn,In,Object(i["h"])("p",null,Object(i["v"])(e.value.testtext),1),Object(i["h"])(c,{name:"",modelValue:e.value.testtext,"onUpdate:modelValue":t[1]||(t[1]=t=>e.value.testtext=t)},null,8,["modelValue"])])}var Sn=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(c["d"])(t,e),Object(c["c"])([Object(a["c"])()],t.prototype,"value",void 0),t=Object(c["c"])([Object(a["b"])({components:{InputOption:st}})],t),t}(a["e"]),Pn=Sn;Pn.render=Mn;var En=Pn,_n=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.editor=new f,t.viewPlugin=new De,t.focusState="blur",t.counter=1,t}return Object(c["d"])(t,e),t.prototype.created=function(){this.viewPlugin.components.node=Object(i["l"])(on),this.viewPlugin.enableMinimap=!0,this.editor.use(this.viewPlugin),this.engine=new qe(!0),this.engine.events.calculated.addListener(this,(function(e){var t,n;try{for(var o=Object(c["h"])(e.values()),i=o.next();!i.done;i=o.next()){var r=i.value;console.log(r)}}catch(s){t={error:s}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}})),this.engine.hooks.gatherCalculationData.tap(this,(function(){return"def"})),this.editor.use(this.engine),this.nodeInterfaceTypes=new Ge,this.editor.use(this.nodeInterfaceTypes),this.editor.use(new Kt),this.viewPlugin.hooks.renderNode.tap(this,(function(e){return"TestNode"===e.node.type&&(e.$el.style.backgroundColor="red"),e})),this.viewPlugin.registerOption("AddOption",jn),this.viewPlugin.registerOption("TriggerOption",Nn),this.viewPlugin.registerOption("SidebarOption",En),this.editor.registerNodeType("TestNode",sn,"Tests"),this.editor.registerNodeType("OutputNode",an,"Outputs"),this.editor.registerNodeType("BuilderTestNode",un,"Tests"),this.editor.registerNodeType("MathNode",dn),this.editor.registerNodeType("AdvancedNode",ln),this.editor.registerNodeType("CommentNode",hn),this.editor.registerNodeType("OptionTestNode",vn),this.editor.registerNodeType("SelectTestNode",bn),this.editor.registerNodeType("SplitterNode",mn),this.editor.addNode(new sn),this.editor.addNode(new sn),this.editor.addNode(new sn),this.editor.addNode(new an),this.editor.addNode(new un),this.editor.addNode(new ln),this.nodeInterfaceTypes.addType("string","#00FF00").addType("number","red").addType("boolean","purple").addConversion("string","number",(function(e){return parseInt(e,10)})).addConversion("number","string",(function(e){return null!==e&&void 0!==e&&e.toString()||"0"})).addConversion("boolean","string",(function(e){return"boolean"===typeof e?e.toString():"null"})),this.viewPlugin.setNodeTypeAlias("TestNode","TestNode (with alias)")},t.prototype.calculate=function(){return Object(c["b"])(this,void 0,void 0,(function(){return Object(c["e"])(this,(function(e){return[2]}))}))},t.prototype.save=function(){console.log(JSON.stringify(this.editor.save()))},t.prototype.load=function(){var e=prompt();e&&this.editor.load(JSON.parse(e))},t.prototype.setSelectItems=function(){var e,t;try{for(var n=Object(c["h"])(this.editor.nodes),o=n.next();!o.done;o=n.next()){var i=o.value;if("SelectTestNode"===i.type){var r=i.options.get("Advanced");r.items=[{text:"X",value:1},{text:i.id,value:2}],r.events.updated.emit()}}}catch(s){e={error:s}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}},t.prototype.changeGridSize=function(){this.viewPlugin.backgroundGrid.gridSize=Math.round(100*Math.random())+100},t}(a["e"]),Tn=_n;n("bc59");Tn.render=s;var Vn=Tn,Bn=(n("ead4"),n("16ac"),Object(i["e"])(Vn,{}));Bn.use(Ae),Bn.mount("#app")},ead4:function(e,t,n){}});
//# sourceMappingURL=app.c0a2280f.js.map